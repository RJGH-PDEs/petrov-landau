(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 14.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    167478,       4044]
NotebookOptionsPosition[    159325,       3922]
NotebookOutlinePosition[    159749,       3939]
CellTagsIndexPosition[    159706,       3936]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.936379177171983*^9, 
  3.936379178846299*^9}},ExpressionUUID->"d0d9a694-3679-4108-bfea-\
27ee88836749"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "rp", ",", " ", "tp", ",", " ", "pp", ",", " ", "rq", ",", " ", "tq", ",", 
    " ", "pq"}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Basis", " ", "parameters"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Basis", " ", "function"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", " ", "=", " ", 
   RowBox[{"l", " ", "+", " ", 
    RowBox[{"1", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"c", " ", "=", " ", 
   RowBox[{"Sqrt", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", "l"}], "+", "1"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"2", " ", "Pi"}], ")"}]}], " ", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"Factorial", "[", 
        RowBox[{"l", " ", "-", " ", "m"}], "]"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"Factorial", "[", 
        RowBox[{"l", "+", " ", "m"}], "]"}], ")"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Test function:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"LaguerreL", "[", 
       RowBox[{"k", ",", " ", "a", " ", ",", " ", 
        RowBox[{"r", "^", "2"}]}], "]"}], 
      RowBox[{"r", "^", "l"}], "*", " ", 
      RowBox[{"LegendreP", "[", 
       RowBox[{"l", ",", 
        RowBox[{"Abs", "[", "m", "]"}], ",", " ", 
        RowBox[{"Cos", "[", "t", "]"}]}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{"m", " ", "p"}], "]"}]}], " ", ",", " ", 
     RowBox[{"Assumptions", "->", 
      RowBox[{
       RowBox[{"Sin", "[", "t", "]"}], ">", " ", "0"}]}]}], "]"}]}], " ", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "s", " ", "now", " ", "contains", " ", "the", " ", "basis", " ", 
    "element"}], "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Evaluation", " ", "points", " ", "p", " ", "and", " ", "q"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"rp", " ", "=", "  ", "1"}], ";", "\[IndentingNewLine]", 
    RowBox[{"tp", " ", "=", " ", 
     RowBox[{"Pi", "/", "3"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"pp", " ", "=", " ", 
     RowBox[{"Pi", "/", "5"}]}], ";", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"rq", " ", "=", " ", "2"}], ";", "\[IndentingNewLine]", 
    RowBox[{"tq", " ", "=", " ", 
     RowBox[{"Pi", "/", "7"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"pq", " ", "=", " ", 
     RowBox[{"Pi", "/", "4"}]}], ";"}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "partials", " ", "for", " ", "the", " ", "gradient"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fr", "[", 
     RowBox[{"r_", " ", ",", "t_", ",", " ", "p_"}], "]"}], ":=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"s", ",", " ", "r"}], "]"}], "]"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ft", "[", 
    RowBox[{"r_", ",", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"s", ",", " ", "t"}], "]"}], "]"}], "/", "r"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fp", "[", 
     RowBox[{"r_", ",", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"s", ",", " ", "p"}], "]"}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"r", " ", 
       RowBox[{"Sin", "[", "t", "]"}]}], ")"}]}]}], ";"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "spherical", " ", "basis"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v1", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "t", "]"}], 
      RowBox[{"Cos", "[", "p", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Sin", "[", "t", "]"}], 
      RowBox[{"Sin", "[", "p", "]"}]}], ",", " ", 
     RowBox[{"Cos", "[", "t", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "t", "]"}], 
      RowBox[{"Cos", "[", "p", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Cos", "[", "t", "]"}], 
      RowBox[{"Sin", "[", "p", "]"}]}], ",", " ", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v3", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "p", "]"}]}], ",", " ", 
      RowBox[{"Cos", "[", "p", "]"}], ",", " ", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "computes", " ", "the", " ", "difference", " ", "in", " ", 
    "gradient"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Gradient difference: \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fr", "[", 
     RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v1"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"ft", "[", 
     RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v2"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"fp", "[", 
     RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v3"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradDiff", " ", "=", " ", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"fr", "[", 
            RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v1"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"ft", "[", 
            RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v2"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"fp", "[", 
            RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v3"}]}], "]"}], "/.", 
        RowBox[{"r", " ", "->", "  ", "rp"}]}], " ", "/.", " ", 
       RowBox[{"t", "->", " ", "tp"}]}], " ", "/.", 
      RowBox[{"p", " ", "->", " ", "pp"}]}], "]"}], " ", "-", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"fr", "[", 
            RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v1"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"ft", "[", 
            RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v2"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"fp", "[", 
            RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v3"}]}], "]"}], "/.", 
        RowBox[{"r", " ", "->", "rq"}]}], " ", "/.", " ", 
       RowBox[{"t", "->", " ", "tq"}]}], " ", "/.", 
      RowBox[{"p", " ", "->", " ", "pq"}]}], "]"}]}]}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Computes", " ", "relative", " ", "postition"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pos", " ", "=", " ", 
   RowBox[{"r", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"Cos", "[", "p", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"Sin", "[", "p", "]"}]}], ",", " ", 
      RowBox[{"Cos", "[", "t", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Relative position: \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"relpos", " ", "=", " ", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pos", " ", "/.", 
        RowBox[{"r", " ", "->", "  ", "rp"}]}], " ", "/.", " ", 
       RowBox[{"t", "->", " ", "tp"}]}], " ", "/.", 
      RowBox[{"p", " ", "->", " ", "pp"}]}], "]"}], " ", "-", " ", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pos", " ", "/.", 
        RowBox[{"r", " ", "->", "  ", "rq"}]}], " ", "/.", " ", 
       RowBox[{"t", "->", " ", "tq"}]}], " ", "/.", 
      RowBox[{"p", " ", "->", " ", "pq"}]}], "]"}]}]}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Now", " ", "take", " ", "inner", " ", "product", "  ", "to", " ", "get", "  ",
     "the", " ", "partial", " ", "result"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Partial Result:\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partialResult", " ", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"-", "2"}], ")"}], 
    RowBox[{"Dot", "[", 
     RowBox[{"gradDiff", ",", " ", "relpos"}], "]"}]}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "Now", " ", "we", " ", "deal", " ", "with", " ", "the", " ", "spherical", 
    " ", "hessian"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a11", "[", 
   RowBox[{"r_", ",", " ", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"D", "[", 
    RowBox[{"s", ",", 
     RowBox[{"{", 
      RowBox[{"r", ",", "2"}], "}"}]}], "]"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a12", "[", 
   RowBox[{"r_", ",", " ", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"s", ",", " ", "r", ",", " ", "t"}], "]"}], "/", "r"}], " ", 
    "-", " ", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"s", ",", " ", "t"}], "]"}], "/", 
     RowBox[{"r", "^", "2"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a13", "[", 
   RowBox[{"r_", ",", " ", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"s", ",", " ", "r", ",", " ", "p"}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"r", " ", 
       RowBox[{"Sin", "[", "t", "]"}]}], ")"}]}], " ", "-", " ", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"s", ",", " ", "p"}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r", "^", "2"}], " ", 
       RowBox[{"Sin", "[", "t", "]"}]}], ")"}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a22", "[", 
   RowBox[{"r_", ",", " ", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"s", ",", " ", 
       RowBox[{"{", 
        RowBox[{"t", ",", " ", "2"}], "}"}]}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"r", "^", "2"}], ")"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"s", ",", " ", "r"}], "]"}], "/", 
     RowBox[{"(", "r", ")"}]}]}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a23", "[", 
   RowBox[{"r_", ",", " ", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"D", "[", 
      RowBox[{"s", ",", " ", "t", ",", " ", "p"}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r", "^", "2"}], 
       RowBox[{"Sin", "[", "t", "]"}]}], ")"}]}], " ", "-", " ", 
    RowBox[{
     RowBox[{"Cos", "[", "t", "]"}], 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"s", ",", " ", "p"}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", "^", "2"}], " ", 
        RowBox[{
         RowBox[{"Sin", "[", "t", "]"}], "^", "2"}]}], ")"}]}]}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"a33", "[", 
    RowBox[{"r_", ",", " ", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"s", ",", " ", 
        RowBox[{"{", 
         RowBox[{"p", ",", "2"}], "}"}]}], "]"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", "^", "2"}], " ", 
        RowBox[{
         RowBox[{"Sin", "[", "t", "]"}], "^", "2"}]}], ")"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{"s", ",", " ", "r"}], "]"}], "/", 
      RowBox[{"(", "r", ")"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"Cos", "[", "t", "]"}], 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{"s", ",", "t"}], "]"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", "^", "2"}], " ", 
         RowBox[{"Sin", "[", "t", "]"}]}], ")"}]}]}]}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"and", " ", "the", " ", "hessian", " ", "basis"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Outer", "[", 
   RowBox[{"Times", ",", " ", "v1", ",", " ", "v1"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Outer", "[", 
   RowBox[{"Times", ",", " ", "v1", ",", " ", "v2"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Outer", "[", 
   RowBox[{"Times", ",", " ", "v1", ",", " ", "v3"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Outer", "[", 
   RowBox[{"Times", ",", " ", "v2", ",", " ", "v2"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Outer", "[", 
   RowBox[{"Times", ",", " ", "v2", ",", " ", "v3"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Outer", "[", 
    RowBox[{"Times", ",", " ", "v3", ",", " ", "v3"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"and", " ", "we", " ", "compute", " ", "the", " ", "hessian"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"hess", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"a11", "[", 
      RowBox[{"r", ",", "t", ",", "p"}], "]"}], " ", 
     RowBox[{"Outer", "[", 
      RowBox[{"Times", ",", " ", "v1", ",", " ", "v1"}], "]"}]}], " ", "+", 
    " ", 
    RowBox[{
     RowBox[{"a22", "[", 
      RowBox[{"r", ",", "t", ",", "p"}], "]"}], 
     RowBox[{"Outer", "[", 
      RowBox[{"Times", ",", "v2", ",", " ", "v2"}], "]"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"a33", "[", 
      RowBox[{"r", ",", "t", ",", "p"}], "]"}], 
     RowBox[{"Outer", "[", 
      RowBox[{"Times", ",", " ", "v3", ",", " ", "v3"}], "]"}]}], " ", "+", 
    " ", 
    RowBox[{
     RowBox[{"a12", "[", 
      RowBox[{"r", ",", "t", ",", "p"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", "v1", ",", " ", "v2"}], "]"}], "+", " ", 
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", "v2", ",", " ", "v1"}], "]"}]}], ")"}]}], 
    " ", "+", " ", 
    RowBox[{
     RowBox[{"a13", "[", 
      RowBox[{"r", ",", "t", ",", "p"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", "v1", ",", " ", "v3"}], "]"}], "+", 
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", "v3", ",", " ", "v1"}], "]"}]}], ")"}]}], 
    "+", 
    RowBox[{
     RowBox[{"a23", "[", 
      RowBox[{"r", ",", "t", ",", "p"}], "]"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", "v2", ",", " ", "v3"}], "]"}], "+", 
       RowBox[{"Outer", "[", 
        RowBox[{"Times", ",", " ", "v3", ",", " ", "v2"}], "]"}]}], 
      ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Hessian: \>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", "hess", "]"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "we", " ", "evaluate", " ", "the", " ", "hessian", " ", "at", " ", "these",
     " ", "two", " ", "points"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"sumhess", " ", "=", " ", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"hess", " ", "/.", 
          RowBox[{"r", " ", "->", "  ", "rp"}]}], " ", "/.", " ", 
         RowBox[{"t", "->", " ", "tp"}]}], " ", "/.", 
        RowBox[{"p", " ", "->", " ", "pp"}]}], ")"}], " ", "+", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"hess", " ", "/.", 
          RowBox[{"r", " ", "->", "  ", "rq"}]}], " ", "/.", " ", 
         RowBox[{"t", "->", " ", "tq"}]}], " ", "/.", 
        RowBox[{"p", " ", "->", " ", "pq"}]}], ")"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Produce", " ", "the", " ", "projection", " ", "matrix"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proj", " ", "=", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "3", "]"}], 
      RowBox[{"Dot", "[", 
       RowBox[{"relpos", ",", " ", "relpos"}], "]"}]}], "-", " ", 
     RowBox[{"Outer", "[", 
      RowBox[{"Times", ",", " ", "relpos", ",", " ", "relpos"}], "]"}]}]}], 
   ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Contract", " ", "them"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Contraction: \>\"", "]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"contraction", " ", "=", " ", 
   RowBox[{
    RowBox[{"Tr", "[", 
     RowBox[{"sumhess", ".", "proj"}], "]"}], "/", "2"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Weight", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Weight result: \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"weight", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{"(", 
    RowBox[{"partialResult", " ", "+", " ", "contraction"}], ")"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.934545215680477*^9, 3.9345452517167788`*^9}, {
   3.934546078568581*^9, 3.934546116156879*^9}, {3.934546196707571*^9, 
   3.93454623381477*^9}, {3.934546265811753*^9, 3.934546358165246*^9}, {
   3.934547066652918*^9, 3.9345471124306517`*^9}, {3.934547277536615*^9, 
   3.934547288364058*^9}, {3.934547323411396*^9, 3.93454745906361*^9}, {
   3.934547592703836*^9, 3.9345475931194773`*^9}, {3.934547782877901*^9, 
   3.934547804698846*^9}, {3.9345555372975397`*^9, 3.934555553677552*^9}, {
   3.934555593983006*^9, 3.934555654869773*^9}, 3.934561134101041*^9, {
   3.934561435991459*^9, 3.934561436233461*^9}, {3.934561782421257*^9, 
   3.934561791395069*^9}, {3.934562423244274*^9, 3.934562432316432*^9}, 
   3.9345625396650963`*^9, {3.934562574285895*^9, 3.934562584538075*^9}, {
   3.934635176410748*^9, 3.934635178608299*^9}, {3.934642120126878*^9, 
   3.934642120322468*^9}, {3.934642910091438*^9, 3.934642919778449*^9}, {
   3.934643776502577*^9, 3.934643776821343*^9}, {3.93464402862075*^9, 
   3.9346440672699428`*^9}, {3.934644126586258*^9, 3.934644126783174*^9}, {
   3.934644993788048*^9, 3.934644996786243*^9}, {3.934645028148741*^9, 
   3.934645032249123*^9}, {3.934645082517102*^9, 3.934645084878615*^9}, {
   3.934645286395956*^9, 3.934645291442677*^9}, {3.934645756197803*^9, 
   3.9346457639823437`*^9}, {3.934646748684247*^9, 3.934646750264111*^9}, {
   3.934646814152014*^9, 3.934646815021612*^9}, {3.93464685952182*^9, 
   3.9346469603169317`*^9}, {3.934647019853184*^9, 3.934647149066936*^9}, {
   3.934647181431975*^9, 3.934647181642997*^9}, {3.934647433298176*^9, 
   3.934647725552042*^9}, {3.9346477612502317`*^9, 3.934647795087501*^9}, {
   3.934647843924931*^9, 3.934647844118456*^9}, {3.934647900507603*^9, 
   3.934647901275125*^9}, {3.934647958583415*^9, 3.934647990020334*^9}, {
   3.934648023635021*^9, 3.934648038675951*^9}, {3.934648073133132*^9, 
   3.934648163405626*^9}, {3.934648195316585*^9, 3.934648199766347*^9}, {
   3.934648315478273*^9, 3.934648316757669*^9}, {3.934648598357017*^9, 
   3.934648604403526*^9}, {3.934648635495606*^9, 3.934648686827787*^9}, {
   3.934649625165648*^9, 3.9346496497177277`*^9}, {3.934649705027893*^9, 
   3.934649805087366*^9}, {3.934649892939668*^9, 3.934650055812196*^9}, {
   3.934650088057495*^9, 3.934650234176309*^9}, {3.93465029132981*^9, 
   3.93465032290089*^9}, {3.934650375483386*^9, 3.934650391228405*^9}, {
   3.934650851785348*^9, 3.934650856827772*^9}, {3.934650906575975*^9, 
   3.934650992463779*^9}, {3.934651075668051*^9, 3.934651104697365*^9}, {
   3.934652792300955*^9, 3.934652826058264*^9}, {3.93465286774352*^9, 
   3.934652912919731*^9}, {3.934652997497385*^9, 3.934653201236381*^9}, {
   3.934653568086797*^9, 3.934653568444565*^9}, {3.934662666784147*^9, 
   3.93466267569679*^9}, {3.934662858891817*^9, 3.93466288586734*^9}, {
   3.934662923979767*^9, 3.934662956295187*^9}, 3.935240749895573*^9, {
   3.9352408023234863`*^9, 3.935240803906374*^9}, {3.935241037345108*^9, 
   3.935241065169447*^9}, {3.935250334677171*^9, 3.93525033587928*^9}, {
   3.935250378932046*^9, 3.935250379262269*^9}, {3.935250595566188*^9, 
   3.93525062331715*^9}, {3.935250739604321*^9, 3.935250739913829*^9}, {
   3.936029038442558*^9, 3.936029042782539*^9}, {3.936029410694378*^9, 
   3.936029434835393*^9}, {3.936031075528804*^9, 3.936031103438121*^9}, {
   3.936033489909237*^9, 3.936033518643126*^9}, {3.936033987556048*^9, 
   3.936033989274721*^9}, {3.936034029437344*^9, 3.936034030759302*^9}, {
   3.9360340814506187`*^9, 3.93603408167638*^9}, {3.936034187527912*^9, 
   3.936034211028908*^9}, {3.9360344003376627`*^9, 3.9360344698378773`*^9}, {
   3.936034786545549*^9, 3.9360347870080748`*^9}, {3.936034881945256*^9, 
   3.936034883231398*^9}, {3.936035751714669*^9, 3.9360357531778584`*^9}, {
   3.9361941347944307`*^9, 3.936194201602292*^9}, {3.9363623768764143`*^9, 
   3.936362377100404*^9}, 3.936369766310333*^9, {3.936379334652911*^9, 
   3.9363793600449123`*^9}, {3.9363795317277822`*^9, 3.936379531965905*^9}},
 CellLabel->
  "In[798]:=",ExpressionUUID->"68a86d45-4d3f-440c-bb66-18be05013b7d"],

Cell[BoxData["\<\"Test function:\"\>"], "Print",
 CellChangeTimes->{{3.934647523419259*^9, 3.934647625778064*^9}, 
   3.934647687482502*^9, {3.934647720021162*^9, 3.934647726186639*^9}, {
   3.934647775188197*^9, 3.934647796083047*^9}, 3.934647845684391*^9, {
   3.934647893378641*^9, 3.934647905959881*^9}, {3.934647965744204*^9, 
   3.934647990421006*^9}, {3.9346480653873*^9, 3.934648164378627*^9}, 
   3.9346482002729588`*^9, 3.9346482663416147`*^9, 3.934648318758972*^9, 
   3.934648604768312*^9, {3.934648652541504*^9, 3.934648687894021*^9}, {
   3.934649781686335*^9, 3.934649806079066*^9}, 3.934649920976519*^9, {
   3.934650010234178*^9, 3.9346500566047707`*^9}, {3.93465018788309*^9, 
   3.934650235698914*^9}, 3.9346502761221848`*^9, {3.934650312771174*^9, 
   3.934650324321582*^9}, 3.934650392075851*^9, {3.934650917067885*^9, 
   3.93465095314*^9}, 3.934650993455058*^9, 3.9346510917050047`*^9, 
   3.93465291394914*^9, {3.934653034530128*^9, 3.9346530469315557`*^9}, 
   3.9346530880541077`*^9, 3.9346531464693947`*^9, {3.9346531832098*^9, 
   3.9346532020421543`*^9}, 3.934653570126968*^9, {3.934662679921269*^9, 
   3.9346627018114853`*^9}, 3.934662738552721*^9, {3.934662876896356*^9, 
   3.934662887141284*^9}, {3.934662931005734*^9, 3.934662956845251*^9}, 
   3.935240740498039*^9, {3.935240791356477*^9, 3.9352408064694023`*^9}, {
   3.935241046530495*^9, 3.935241068145925*^9}, 3.935250341241066*^9, 
   3.935250383404915*^9, {3.9352506001479993`*^9, 3.935250627655177*^9}, 
   3.935250743519598*^9, 3.936029048147219*^9, {3.936029479630287*^9, 
   3.936029483067447*^9}, 3.936029527617996*^9, 3.9360311072127438`*^9, 
   3.9360328550389357`*^9, 3.936033520725393*^9, 3.93603399073104*^9, 
   3.936034031866658*^9, 3.936034085284671*^9, 3.93603421348031*^9, {
   3.936034462060647*^9, 3.936034472147016*^9}, 3.9360347887682247`*^9, 
   3.936034884311159*^9, 3.93603498250981*^9, {3.936194185919437*^9, 
   3.936194203029585*^9}, 3.936357198969326*^9, 3.936362378915915*^9, 
   3.936379182969203*^9, {3.936379336732615*^9, 3.936379360445992*^9}, 
   3.936379534012681*^9},
 CellLabel->
  "During evaluation of \
In[798]:=",ExpressionUUID->"3188b5d4-db06-4f2b-bafc-0724d4174f1b"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "r", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "5"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["r", "2"]}]}], ")"}], " ", 
  RowBox[{"Cos", "[", "p", "]"}], " ", 
  RowBox[{"Sin", "[", "t", "]"}]}]], "Output",
 CellChangeTimes->{
  3.934561366795213*^9, 3.93456143718443*^9, {3.9345617840011044`*^9, 
   3.934561792302905*^9}, {3.934562411062694*^9, 3.934562432884573*^9}, 
   3.934562540588208*^9, {3.934562575279674*^9, 3.934562585317964*^9}, 
   3.934635180131947*^9, 3.934642120929764*^9, 3.934642920526026*^9, 
   3.934643443433602*^9, 3.934643778091479*^9, 3.9346439813171*^9, 
   3.934644030244637*^9, 3.934644069612084*^9, 3.934644127421257*^9, {
   3.934644910048142*^9, 3.934644949455341*^9}, {3.934644989134675*^9, 
   3.934645032827955*^9}, 3.934645085325982*^9, 3.934645292561574*^9, 
   3.934645771381077*^9, 3.934646481393003*^9, 3.934646750884302*^9, 
   3.934646816062078*^9, 3.934646861688303*^9, {3.9346469014863358`*^9, 
   3.934646928243171*^9}, {3.9346469613375807`*^9, 3.934646986971951*^9}, {
   3.93464708621241*^9, 3.9346471121023483`*^9}, 3.934647150501734*^9, {
   3.934647182912912*^9, 3.934647186359703*^9}, {3.934647457862175*^9, 
   3.934647625779133*^9}, 3.934647687483698*^9, {3.934647720022428*^9, 
   3.934647726187817*^9}, {3.934647775189315*^9, 3.9346477960846157`*^9}, 
   3.934647845685845*^9, {3.934647893379798*^9, 3.934647905961093*^9}, {
   3.934647965745398*^9, 3.93464799042232*^9}, {3.934648065388516*^9, 
   3.934648164380046*^9}, 3.934648200274085*^9, 3.934648266342901*^9, 
   3.934648318760189*^9, 3.934648604769577*^9, {3.934648652542721*^9, 
   3.934648687895195*^9}, {3.934649781687509*^9, 3.934649806080364*^9}, 
   3.93464992097771*^9, {3.934650010235275*^9, 3.934650056605849*^9}, {
   3.934650187884338*^9, 3.934650235699989*^9}, 3.934650276123374*^9, {
   3.934650312772275*^9, 3.934650324322674*^9}, 3.934650392076933*^9, {
   3.934650917069077*^9, 3.934650953141036*^9}, 3.934650993456414*^9, 
   3.9346510917060623`*^9, 3.934652913950248*^9, {3.934653034531282*^9, 
   3.934653046932794*^9}, 3.934653088055225*^9, 3.934653146470546*^9, {
   3.934653183210965*^9, 3.9346532020432777`*^9}, 3.9346535701281*^9, {
   3.934662679973946*^9, 3.9346627018125*^9}, 3.934662738554541*^9, {
   3.934662876896912*^9, 3.934662887143652*^9}, {3.934662931006379*^9, 
   3.934662956845815*^9}, 3.9352407405242577`*^9, {3.935240791357108*^9, 
   3.935240806469895*^9}, {3.935241046531017*^9, 3.93524106814644*^9}, 
   3.935250341276455*^9, 3.935250383405522*^9, {3.935250600148654*^9, 
   3.935250627660886*^9}, 3.935250743520183*^9, 3.936029048210071*^9, {
   3.936029479650715*^9, 3.936029483068028*^9}, 3.936029527618685*^9, 
   3.936031107233344*^9, 3.9360328550395203`*^9, 3.936033520725968*^9, 
   3.9360339907315474`*^9, 3.936034031867193*^9, 3.936034085285186*^9, 
   3.9360342134808187`*^9, {3.936034462061247*^9, 3.936034472147532*^9}, 
   3.936034788768738*^9, 3.936034884311676*^9, 3.936034982510338*^9, {
   3.936194185961627*^9, 3.936194203030558*^9}, 3.936357199014501*^9, 
   3.936362378954946*^9, 3.936379182970586*^9, {3.9363793367335157`*^9, 
   3.936379360448197*^9}, 3.936379534013815*^9},
 CellLabel->
  "Out[805]=",ExpressionUUID->"3b4d84f3-3c28-4dea-9c36-f9febe47120a"],

Cell[BoxData["\<\"Gradient difference: \"\>"], "Print",
 CellChangeTimes->{{3.934647523419259*^9, 3.934647625778064*^9}, 
   3.934647687482502*^9, {3.934647720021162*^9, 3.934647726186639*^9}, {
   3.934647775188197*^9, 3.934647796083047*^9}, 3.934647845684391*^9, {
   3.934647893378641*^9, 3.934647905959881*^9}, {3.934647965744204*^9, 
   3.934647990421006*^9}, {3.9346480653873*^9, 3.934648164378627*^9}, 
   3.9346482002729588`*^9, 3.9346482663416147`*^9, 3.934648318758972*^9, 
   3.934648604768312*^9, {3.934648652541504*^9, 3.934648687894021*^9}, {
   3.934649781686335*^9, 3.934649806079066*^9}, 3.934649920976519*^9, {
   3.934650010234178*^9, 3.9346500566047707`*^9}, {3.93465018788309*^9, 
   3.934650235698914*^9}, 3.9346502761221848`*^9, {3.934650312771174*^9, 
   3.934650324321582*^9}, 3.934650392075851*^9, {3.934650917067885*^9, 
   3.93465095314*^9}, 3.934650993455058*^9, 3.9346510917050047`*^9, 
   3.93465291394914*^9, {3.934653034530128*^9, 3.9346530469315557`*^9}, 
   3.9346530880541077`*^9, 3.9346531464693947`*^9, {3.9346531832098*^9, 
   3.9346532020421543`*^9}, 3.934653570126968*^9, {3.934662679921269*^9, 
   3.9346627018114853`*^9}, 3.934662738552721*^9, {3.934662876896356*^9, 
   3.934662887141284*^9}, {3.934662931005734*^9, 3.934662956845251*^9}, 
   3.935240740498039*^9, {3.935240791356477*^9, 3.9352408064694023`*^9}, {
   3.935241046530495*^9, 3.935241068145925*^9}, 3.935250341241066*^9, 
   3.935250383404915*^9, {3.9352506001479993`*^9, 3.935250627655177*^9}, 
   3.935250743519598*^9, 3.936029048147219*^9, {3.936029479630287*^9, 
   3.936029483067447*^9}, 3.936029527617996*^9, 3.9360311072127438`*^9, 
   3.9360328550389357`*^9, 3.936033520725393*^9, 3.93603399073104*^9, 
   3.936034031866658*^9, 3.936034085284671*^9, 3.93603421348031*^9, {
   3.936034462060647*^9, 3.936034472147016*^9}, 3.9360347887682247`*^9, 
   3.936034884311159*^9, 3.93603498250981*^9, {3.936194185919437*^9, 
   3.936194203029585*^9}, 3.936357198969326*^9, 3.936362378915915*^9, 
   3.936379182969203*^9, {3.936379336732615*^9, 3.936379360445992*^9}, 
   3.9363795340153313`*^9},
 CellLabel->
  "During evaluation of \
In[798]:=",ExpressionUUID->"eaeb2018-7079-4c77-ab6c-acd4592590c5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"Cos", "[", "p", "]"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "5"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["r", "2"]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["r", "2"], " ", 
          RowBox[{"Cos", "[", 
           RowBox[{"2", " ", "t"}], "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "5"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["r", "2"]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"Sin", "[", "p", "]"}], "2"]}]}], ")"}]}], ",", 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "p"}], "]"}], " ", 
    SuperscriptBox[
     RowBox[{"Sin", "[", "t", "]"}], "2"]}], ",", 
   RowBox[{
    SuperscriptBox["r", "2"], " ", 
    RowBox[{"Cos", "[", "p", "]"}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{"2", " ", "t"}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.934561366795213*^9, 3.93456143718443*^9, {3.9345617840011044`*^9, 
   3.934561792302905*^9}, {3.934562411062694*^9, 3.934562432884573*^9}, 
   3.934562540588208*^9, {3.934562575279674*^9, 3.934562585317964*^9}, 
   3.934635180131947*^9, 3.934642120929764*^9, 3.934642920526026*^9, 
   3.934643443433602*^9, 3.934643778091479*^9, 3.9346439813171*^9, 
   3.934644030244637*^9, 3.934644069612084*^9, 3.934644127421257*^9, {
   3.934644910048142*^9, 3.934644949455341*^9}, {3.934644989134675*^9, 
   3.934645032827955*^9}, 3.934645085325982*^9, 3.934645292561574*^9, 
   3.934645771381077*^9, 3.934646481393003*^9, 3.934646750884302*^9, 
   3.934646816062078*^9, 3.934646861688303*^9, {3.9346469014863358`*^9, 
   3.934646928243171*^9}, {3.9346469613375807`*^9, 3.934646986971951*^9}, {
   3.93464708621241*^9, 3.9346471121023483`*^9}, 3.934647150501734*^9, {
   3.934647182912912*^9, 3.934647186359703*^9}, {3.934647457862175*^9, 
   3.934647625779133*^9}, 3.934647687483698*^9, {3.934647720022428*^9, 
   3.934647726187817*^9}, {3.934647775189315*^9, 3.9346477960846157`*^9}, 
   3.934647845685845*^9, {3.934647893379798*^9, 3.934647905961093*^9}, {
   3.934647965745398*^9, 3.93464799042232*^9}, {3.934648065388516*^9, 
   3.934648164380046*^9}, 3.934648200274085*^9, 3.934648266342901*^9, 
   3.934648318760189*^9, 3.934648604769577*^9, {3.934648652542721*^9, 
   3.934648687895195*^9}, {3.934649781687509*^9, 3.934649806080364*^9}, 
   3.93464992097771*^9, {3.934650010235275*^9, 3.934650056605849*^9}, {
   3.934650187884338*^9, 3.934650235699989*^9}, 3.934650276123374*^9, {
   3.934650312772275*^9, 3.934650324322674*^9}, 3.934650392076933*^9, {
   3.934650917069077*^9, 3.934650953141036*^9}, 3.934650993456414*^9, 
   3.9346510917060623`*^9, 3.934652913950248*^9, {3.934653034531282*^9, 
   3.934653046932794*^9}, 3.934653088055225*^9, 3.934653146470546*^9, {
   3.934653183210965*^9, 3.9346532020432777`*^9}, 3.9346535701281*^9, {
   3.934662679973946*^9, 3.9346627018125*^9}, 3.934662738554541*^9, {
   3.934662876896912*^9, 3.934662887143652*^9}, {3.934662931006379*^9, 
   3.934662956845815*^9}, 3.9352407405242577`*^9, {3.935240791357108*^9, 
   3.935240806469895*^9}, {3.935241046531017*^9, 3.93524106814644*^9}, 
   3.935250341276455*^9, 3.935250383405522*^9, {3.935250600148654*^9, 
   3.935250627660886*^9}, 3.935250743520183*^9, 3.936029048210071*^9, {
   3.936029479650715*^9, 3.936029483068028*^9}, 3.936029527618685*^9, 
   3.936031107233344*^9, 3.9360328550395203`*^9, 3.936033520725968*^9, 
   3.9360339907315474`*^9, 3.936034031867193*^9, 3.936034085285186*^9, 
   3.9360342134808187`*^9, {3.936034462061247*^9, 3.936034472147532*^9}, 
   3.936034788768738*^9, 3.936034884311676*^9, 3.936034982510338*^9, {
   3.936194185961627*^9, 3.936194203030558*^9}, 3.936357199014501*^9, 
   3.936362378954946*^9, 3.936379182970586*^9, {3.9363793367335157`*^9, 
   3.936379360448197*^9}, 3.936379534067727*^9},
 CellLabel->
  "Out[813]=",ExpressionUUID->"b1c86be7-8a24-42bc-ade2-1ad1c135e6d5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"0.5`", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", "pp", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5.`"}], "+", 
          RowBox[{"4.`", " ", 
           SuperscriptBox["rp", "2"]}], "-", 
          RowBox[{"2.`", " ", 
           SuperscriptBox["rp", "2"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2.`", " ", "tp"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5.`"}], "+", 
          RowBox[{"2.`", " ", 
           SuperscriptBox["rp", "2"]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "pp", "]"}], "2"]}]}], ")"}]}], "-", 
    RowBox[{"0.5`", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox[
         RowBox[{"Cos", "[", "pq", "]"}], "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5.`"}], "+", 
          RowBox[{"4.`", " ", 
           SuperscriptBox["rq", "2"]}], "-", 
          RowBox[{"2.`", " ", 
           SuperscriptBox["rq", "2"], " ", 
           RowBox[{"Cos", "[", 
            RowBox[{"2.`", " ", "tq"}], "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5.`"}], "+", 
          RowBox[{"2.`", " ", 
           SuperscriptBox["rq", "2"]}]}], ")"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "pq", "]"}], "2"]}]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["rp", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2.`", " ", "pp"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "tp", "]"}], "2"]}], "-", 
    RowBox[{
     SuperscriptBox["rq", "2"], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2.`", " ", "pq"}], "]"}], " ", 
     SuperscriptBox[
      RowBox[{"Sin", "[", "tq", "]"}], "2"]}]}], ",", 
   RowBox[{
    RowBox[{
     SuperscriptBox["rp", "2"], " ", 
     RowBox[{"Cos", "[", "pp", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2.`", " ", "tp"}], "]"}]}], "-", 
    RowBox[{
     SuperscriptBox["rq", "2"], " ", 
     RowBox[{"Cos", "[", "pq", "]"}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{"2.`", " ", "tq"}], "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.934561366795213*^9, 3.93456143718443*^9, {3.9345617840011044`*^9, 
   3.934561792302905*^9}, {3.934562411062694*^9, 3.934562432884573*^9}, 
   3.934562540588208*^9, {3.934562575279674*^9, 3.934562585317964*^9}, 
   3.934635180131947*^9, 3.934642120929764*^9, 3.934642920526026*^9, 
   3.934643443433602*^9, 3.934643778091479*^9, 3.9346439813171*^9, 
   3.934644030244637*^9, 3.934644069612084*^9, 3.934644127421257*^9, {
   3.934644910048142*^9, 3.934644949455341*^9}, {3.934644989134675*^9, 
   3.934645032827955*^9}, 3.934645085325982*^9, 3.934645292561574*^9, 
   3.934645771381077*^9, 3.934646481393003*^9, 3.934646750884302*^9, 
   3.934646816062078*^9, 3.934646861688303*^9, {3.9346469014863358`*^9, 
   3.934646928243171*^9}, {3.9346469613375807`*^9, 3.934646986971951*^9}, {
   3.93464708621241*^9, 3.9346471121023483`*^9}, 3.934647150501734*^9, {
   3.934647182912912*^9, 3.934647186359703*^9}, {3.934647457862175*^9, 
   3.934647625779133*^9}, 3.934647687483698*^9, {3.934647720022428*^9, 
   3.934647726187817*^9}, {3.934647775189315*^9, 3.9346477960846157`*^9}, 
   3.934647845685845*^9, {3.934647893379798*^9, 3.934647905961093*^9}, {
   3.934647965745398*^9, 3.93464799042232*^9}, {3.934648065388516*^9, 
   3.934648164380046*^9}, 3.934648200274085*^9, 3.934648266342901*^9, 
   3.934648318760189*^9, 3.934648604769577*^9, {3.934648652542721*^9, 
   3.934648687895195*^9}, {3.934649781687509*^9, 3.934649806080364*^9}, 
   3.93464992097771*^9, {3.934650010235275*^9, 3.934650056605849*^9}, {
   3.934650187884338*^9, 3.934650235699989*^9}, 3.934650276123374*^9, {
   3.934650312772275*^9, 3.934650324322674*^9}, 3.934650392076933*^9, {
   3.934650917069077*^9, 3.934650953141036*^9}, 3.934650993456414*^9, 
   3.9346510917060623`*^9, 3.934652913950248*^9, {3.934653034531282*^9, 
   3.934653046932794*^9}, 3.934653088055225*^9, 3.934653146470546*^9, {
   3.934653183210965*^9, 3.9346532020432777`*^9}, 3.9346535701281*^9, {
   3.934662679973946*^9, 3.9346627018125*^9}, 3.934662738554541*^9, {
   3.934662876896912*^9, 3.934662887143652*^9}, {3.934662931006379*^9, 
   3.934662956845815*^9}, 3.9352407405242577`*^9, {3.935240791357108*^9, 
   3.935240806469895*^9}, {3.935241046531017*^9, 3.93524106814644*^9}, 
   3.935250341276455*^9, 3.935250383405522*^9, {3.935250600148654*^9, 
   3.935250627660886*^9}, 3.935250743520183*^9, 3.936029048210071*^9, {
   3.936029479650715*^9, 3.936029483068028*^9}, 3.936029527618685*^9, 
   3.936031107233344*^9, 3.9360328550395203`*^9, 3.936033520725968*^9, 
   3.9360339907315474`*^9, 3.936034031867193*^9, 3.936034085285186*^9, 
   3.9360342134808187`*^9, {3.936034462061247*^9, 3.936034472147532*^9}, 
   3.936034788768738*^9, 3.936034884311676*^9, 3.936034982510338*^9, {
   3.936194185961627*^9, 3.936194203030558*^9}, 3.936357199014501*^9, 
   3.936362378954946*^9, 3.936379182970586*^9, {3.9363793367335157`*^9, 
   3.936379360448197*^9}, 3.93637953406992*^9},
 CellLabel->
  "Out[814]=",ExpressionUUID->"d8c47db5-266e-43d6-845c-f0b6f36daff5"],

Cell[BoxData["\<\"Relative position: \"\>"], "Print",
 CellChangeTimes->{{3.934647523419259*^9, 3.934647625778064*^9}, 
   3.934647687482502*^9, {3.934647720021162*^9, 3.934647726186639*^9}, {
   3.934647775188197*^9, 3.934647796083047*^9}, 3.934647845684391*^9, {
   3.934647893378641*^9, 3.934647905959881*^9}, {3.934647965744204*^9, 
   3.934647990421006*^9}, {3.9346480653873*^9, 3.934648164378627*^9}, 
   3.9346482002729588`*^9, 3.9346482663416147`*^9, 3.934648318758972*^9, 
   3.934648604768312*^9, {3.934648652541504*^9, 3.934648687894021*^9}, {
   3.934649781686335*^9, 3.934649806079066*^9}, 3.934649920976519*^9, {
   3.934650010234178*^9, 3.9346500566047707`*^9}, {3.93465018788309*^9, 
   3.934650235698914*^9}, 3.9346502761221848`*^9, {3.934650312771174*^9, 
   3.934650324321582*^9}, 3.934650392075851*^9, {3.934650917067885*^9, 
   3.93465095314*^9}, 3.934650993455058*^9, 3.9346510917050047`*^9, 
   3.93465291394914*^9, {3.934653034530128*^9, 3.9346530469315557`*^9}, 
   3.9346530880541077`*^9, 3.9346531464693947`*^9, {3.9346531832098*^9, 
   3.9346532020421543`*^9}, 3.934653570126968*^9, {3.934662679921269*^9, 
   3.9346627018114853`*^9}, 3.934662738552721*^9, {3.934662876896356*^9, 
   3.934662887141284*^9}, {3.934662931005734*^9, 3.934662956845251*^9}, 
   3.935240740498039*^9, {3.935240791356477*^9, 3.9352408064694023`*^9}, {
   3.935241046530495*^9, 3.935241068145925*^9}, 3.935250341241066*^9, 
   3.935250383404915*^9, {3.9352506001479993`*^9, 3.935250627655177*^9}, 
   3.935250743519598*^9, 3.936029048147219*^9, {3.936029479630287*^9, 
   3.936029483067447*^9}, 3.936029527617996*^9, 3.9360311072127438`*^9, 
   3.9360328550389357`*^9, 3.936033520725393*^9, 3.93603399073104*^9, 
   3.936034031866658*^9, 3.936034085284671*^9, 3.93603421348031*^9, {
   3.936034462060647*^9, 3.936034472147016*^9}, 3.9360347887682247`*^9, 
   3.936034884311159*^9, 3.93603498250981*^9, {3.936194185919437*^9, 
   3.936194203029585*^9}, 3.936357198969326*^9, 3.936362378915915*^9, 
   3.936379182969203*^9, {3.936379336732615*^9, 3.936379360445992*^9}, 
   3.936379534071886*^9},
 CellLabel->
  "During evaluation of \
In[798]:=",ExpressionUUID->"0031350b-0d34-43f9-9aae-a98c5ae216f4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"rp", " ", 
     RowBox[{"Cos", "[", "pp", "]"}], " ", 
     RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
    RowBox[{"rq", " ", 
     RowBox[{"Cos", "[", "pq", "]"}], " ", 
     RowBox[{"Sin", "[", "tq", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"rp", " ", 
     RowBox[{"Sin", "[", "pp", "]"}], " ", 
     RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
    RowBox[{"rq", " ", 
     RowBox[{"Sin", "[", "pq", "]"}], " ", 
     RowBox[{"Sin", "[", "tq", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"rp", " ", 
     RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
    RowBox[{"rq", " ", 
     RowBox[{"Cos", "[", "tq", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.934561366795213*^9, 3.93456143718443*^9, {3.9345617840011044`*^9, 
   3.934561792302905*^9}, {3.934562411062694*^9, 3.934562432884573*^9}, 
   3.934562540588208*^9, {3.934562575279674*^9, 3.934562585317964*^9}, 
   3.934635180131947*^9, 3.934642120929764*^9, 3.934642920526026*^9, 
   3.934643443433602*^9, 3.934643778091479*^9, 3.9346439813171*^9, 
   3.934644030244637*^9, 3.934644069612084*^9, 3.934644127421257*^9, {
   3.934644910048142*^9, 3.934644949455341*^9}, {3.934644989134675*^9, 
   3.934645032827955*^9}, 3.934645085325982*^9, 3.934645292561574*^9, 
   3.934645771381077*^9, 3.934646481393003*^9, 3.934646750884302*^9, 
   3.934646816062078*^9, 3.934646861688303*^9, {3.9346469014863358`*^9, 
   3.934646928243171*^9}, {3.9346469613375807`*^9, 3.934646986971951*^9}, {
   3.93464708621241*^9, 3.9346471121023483`*^9}, 3.934647150501734*^9, {
   3.934647182912912*^9, 3.934647186359703*^9}, {3.934647457862175*^9, 
   3.934647625779133*^9}, 3.934647687483698*^9, {3.934647720022428*^9, 
   3.934647726187817*^9}, {3.934647775189315*^9, 3.9346477960846157`*^9}, 
   3.934647845685845*^9, {3.934647893379798*^9, 3.934647905961093*^9}, {
   3.934647965745398*^9, 3.93464799042232*^9}, {3.934648065388516*^9, 
   3.934648164380046*^9}, 3.934648200274085*^9, 3.934648266342901*^9, 
   3.934648318760189*^9, 3.934648604769577*^9, {3.934648652542721*^9, 
   3.934648687895195*^9}, {3.934649781687509*^9, 3.934649806080364*^9}, 
   3.93464992097771*^9, {3.934650010235275*^9, 3.934650056605849*^9}, {
   3.934650187884338*^9, 3.934650235699989*^9}, 3.934650276123374*^9, {
   3.934650312772275*^9, 3.934650324322674*^9}, 3.934650392076933*^9, {
   3.934650917069077*^9, 3.934650953141036*^9}, 3.934650993456414*^9, 
   3.9346510917060623`*^9, 3.934652913950248*^9, {3.934653034531282*^9, 
   3.934653046932794*^9}, 3.934653088055225*^9, 3.934653146470546*^9, {
   3.934653183210965*^9, 3.9346532020432777`*^9}, 3.9346535701281*^9, {
   3.934662679973946*^9, 3.9346627018125*^9}, 3.934662738554541*^9, {
   3.934662876896912*^9, 3.934662887143652*^9}, {3.934662931006379*^9, 
   3.934662956845815*^9}, 3.9352407405242577`*^9, {3.935240791357108*^9, 
   3.935240806469895*^9}, {3.935241046531017*^9, 3.93524106814644*^9}, 
   3.935250341276455*^9, 3.935250383405522*^9, {3.935250600148654*^9, 
   3.935250627660886*^9}, 3.935250743520183*^9, 3.936029048210071*^9, {
   3.936029479650715*^9, 3.936029483068028*^9}, 3.936029527618685*^9, 
   3.936031107233344*^9, 3.9360328550395203`*^9, 3.936033520725968*^9, 
   3.9360339907315474`*^9, 3.936034031867193*^9, 3.936034085285186*^9, 
   3.9360342134808187`*^9, {3.936034462061247*^9, 3.936034472147532*^9}, 
   3.936034788768738*^9, 3.936034884311676*^9, 3.936034982510338*^9, {
   3.936194185961627*^9, 3.936194203030558*^9}, 3.936357199014501*^9, 
   3.936362378954946*^9, 3.936379182970586*^9, {3.9363793367335157`*^9, 
   3.936379360448197*^9}, 3.936379534073255*^9},
 CellLabel->
  "Out[817]=",ExpressionUUID->"7903f5e2-e81a-4d85-bf82-cd3a18ae6f51"],

Cell[BoxData["\<\"Partial Result:\"\>"], "Print",
 CellChangeTimes->{{3.934647523419259*^9, 3.934647625778064*^9}, 
   3.934647687482502*^9, {3.934647720021162*^9, 3.934647726186639*^9}, {
   3.934647775188197*^9, 3.934647796083047*^9}, 3.934647845684391*^9, {
   3.934647893378641*^9, 3.934647905959881*^9}, {3.934647965744204*^9, 
   3.934647990421006*^9}, {3.9346480653873*^9, 3.934648164378627*^9}, 
   3.9346482002729588`*^9, 3.9346482663416147`*^9, 3.934648318758972*^9, 
   3.934648604768312*^9, {3.934648652541504*^9, 3.934648687894021*^9}, {
   3.934649781686335*^9, 3.934649806079066*^9}, 3.934649920976519*^9, {
   3.934650010234178*^9, 3.9346500566047707`*^9}, {3.93465018788309*^9, 
   3.934650235698914*^9}, 3.9346502761221848`*^9, {3.934650312771174*^9, 
   3.934650324321582*^9}, 3.934650392075851*^9, {3.934650917067885*^9, 
   3.93465095314*^9}, 3.934650993455058*^9, 3.9346510917050047`*^9, 
   3.93465291394914*^9, {3.934653034530128*^9, 3.9346530469315557`*^9}, 
   3.9346530880541077`*^9, 3.9346531464693947`*^9, {3.9346531832098*^9, 
   3.9346532020421543`*^9}, 3.934653570126968*^9, {3.934662679921269*^9, 
   3.9346627018114853`*^9}, 3.934662738552721*^9, {3.934662876896356*^9, 
   3.934662887141284*^9}, {3.934662931005734*^9, 3.934662956845251*^9}, 
   3.935240740498039*^9, {3.935240791356477*^9, 3.9352408064694023`*^9}, {
   3.935241046530495*^9, 3.935241068145925*^9}, 3.935250341241066*^9, 
   3.935250383404915*^9, {3.9352506001479993`*^9, 3.935250627655177*^9}, 
   3.935250743519598*^9, 3.936029048147219*^9, {3.936029479630287*^9, 
   3.936029483067447*^9}, 3.936029527617996*^9, 3.9360311072127438`*^9, 
   3.9360328550389357`*^9, 3.936033520725393*^9, 3.93603399073104*^9, 
   3.936034031866658*^9, 3.936034085284671*^9, 3.93603421348031*^9, {
   3.936034462060647*^9, 3.936034472147016*^9}, 3.9360347887682247`*^9, 
   3.936034884311159*^9, 3.93603498250981*^9, {3.936194185919437*^9, 
   3.936194203029585*^9}, 3.936357198969326*^9, 3.936362378915915*^9, 
   3.936379182969203*^9, {3.936379336732615*^9, 3.936379360445992*^9}, 
   3.93637953407417*^9},
 CellLabel->
  "During evaluation of \
In[798]:=",ExpressionUUID->"1c7b8737-92c2-4020-a930-70c7c39c30c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "2"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"0.5`", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "pp", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5.`"}], "+", 
             RowBox[{"4.`", " ", 
              SuperscriptBox["rp", "2"]}], "-", 
             RowBox[{"2.`", " ", 
              SuperscriptBox["rp", "2"], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2.`", " ", "tp"}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5.`"}], "+", 
             RowBox[{"2.`", " ", 
              SuperscriptBox["rp", "2"]}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "pp", "]"}], "2"]}]}], ")"}]}], "-", 
       RowBox[{"0.5`", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "pq", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5.`"}], "+", 
             RowBox[{"4.`", " ", 
              SuperscriptBox["rq", "2"]}], "-", 
             RowBox[{"2.`", " ", 
              SuperscriptBox["rq", "2"], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2.`", " ", "tq"}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5.`"}], "+", 
             RowBox[{"2.`", " ", 
              SuperscriptBox["rq", "2"]}]}], ")"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "pq", "]"}], "2"]}]}], ")"}]}]}], ")"}], " ", 
     
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
       RowBox[{"rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rp", " ", 
        RowBox[{"Sin", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
       RowBox[{"rq", " ", 
        RowBox[{"Sin", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["rp", "2"], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2.`", " ", "pp"}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "tp", "]"}], "2"]}], "-", 
       RowBox[{
        SuperscriptBox["rq", "2"], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2.`", " ", "pq"}], "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "tq", "]"}], "2"]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rp", " ", 
        RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
       RowBox[{"rq", " ", 
        RowBox[{"Cos", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["rp", "2"], " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2.`", " ", "tp"}], "]"}]}], "-", 
       RowBox[{
        SuperscriptBox["rq", "2"], " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", 
         RowBox[{"2.`", " ", "tq"}], "]"}]}]}], ")"}]}]}], ")"}]}]], "Output",\

 CellChangeTimes->{
  3.934561366795213*^9, 3.93456143718443*^9, {3.9345617840011044`*^9, 
   3.934561792302905*^9}, {3.934562411062694*^9, 3.934562432884573*^9}, 
   3.934562540588208*^9, {3.934562575279674*^9, 3.934562585317964*^9}, 
   3.934635180131947*^9, 3.934642120929764*^9, 3.934642920526026*^9, 
   3.934643443433602*^9, 3.934643778091479*^9, 3.9346439813171*^9, 
   3.934644030244637*^9, 3.934644069612084*^9, 3.934644127421257*^9, {
   3.934644910048142*^9, 3.934644949455341*^9}, {3.934644989134675*^9, 
   3.934645032827955*^9}, 3.934645085325982*^9, 3.934645292561574*^9, 
   3.934645771381077*^9, 3.934646481393003*^9, 3.934646750884302*^9, 
   3.934646816062078*^9, 3.934646861688303*^9, {3.9346469014863358`*^9, 
   3.934646928243171*^9}, {3.9346469613375807`*^9, 3.934646986971951*^9}, {
   3.93464708621241*^9, 3.9346471121023483`*^9}, 3.934647150501734*^9, {
   3.934647182912912*^9, 3.934647186359703*^9}, {3.934647457862175*^9, 
   3.934647625779133*^9}, 3.934647687483698*^9, {3.934647720022428*^9, 
   3.934647726187817*^9}, {3.934647775189315*^9, 3.9346477960846157`*^9}, 
   3.934647845685845*^9, {3.934647893379798*^9, 3.934647905961093*^9}, {
   3.934647965745398*^9, 3.93464799042232*^9}, {3.934648065388516*^9, 
   3.934648164380046*^9}, 3.934648200274085*^9, 3.934648266342901*^9, 
   3.934648318760189*^9, 3.934648604769577*^9, {3.934648652542721*^9, 
   3.934648687895195*^9}, {3.934649781687509*^9, 3.934649806080364*^9}, 
   3.93464992097771*^9, {3.934650010235275*^9, 3.934650056605849*^9}, {
   3.934650187884338*^9, 3.934650235699989*^9}, 3.934650276123374*^9, {
   3.934650312772275*^9, 3.934650324322674*^9}, 3.934650392076933*^9, {
   3.934650917069077*^9, 3.934650953141036*^9}, 3.934650993456414*^9, 
   3.9346510917060623`*^9, 3.934652913950248*^9, {3.934653034531282*^9, 
   3.934653046932794*^9}, 3.934653088055225*^9, 3.934653146470546*^9, {
   3.934653183210965*^9, 3.9346532020432777`*^9}, 3.9346535701281*^9, {
   3.934662679973946*^9, 3.9346627018125*^9}, 3.934662738554541*^9, {
   3.934662876896912*^9, 3.934662887143652*^9}, {3.934662931006379*^9, 
   3.934662956845815*^9}, 3.9352407405242577`*^9, {3.935240791357108*^9, 
   3.935240806469895*^9}, {3.935241046531017*^9, 3.93524106814644*^9}, 
   3.935250341276455*^9, 3.935250383405522*^9, {3.935250600148654*^9, 
   3.935250627660886*^9}, 3.935250743520183*^9, 3.936029048210071*^9, {
   3.936029479650715*^9, 3.936029483068028*^9}, 3.936029527618685*^9, 
   3.936031107233344*^9, 3.9360328550395203`*^9, 3.936033520725968*^9, 
   3.9360339907315474`*^9, 3.936034031867193*^9, 3.936034085285186*^9, 
   3.9360342134808187`*^9, {3.936034462061247*^9, 3.936034472147532*^9}, 
   3.936034788768738*^9, 3.936034884311676*^9, 3.936034982510338*^9, {
   3.936194185961627*^9, 3.936194203030558*^9}, 3.936357199014501*^9, 
   3.936362378954946*^9, 3.936379182970586*^9, {3.9363793367335157`*^9, 
   3.936379360448197*^9}, 3.9363795340754623`*^9},
 CellLabel->
  "Out[819]=",ExpressionUUID->"ccfe5ce4-ec5a-4260-8c00-df9815a96093"],

Cell[BoxData["\<\"Hessian: \"\>"], "Print",
 CellChangeTimes->{{3.934647523419259*^9, 3.934647625778064*^9}, 
   3.934647687482502*^9, {3.934647720021162*^9, 3.934647726186639*^9}, {
   3.934647775188197*^9, 3.934647796083047*^9}, 3.934647845684391*^9, {
   3.934647893378641*^9, 3.934647905959881*^9}, {3.934647965744204*^9, 
   3.934647990421006*^9}, {3.9346480653873*^9, 3.934648164378627*^9}, 
   3.9346482002729588`*^9, 3.9346482663416147`*^9, 3.934648318758972*^9, 
   3.934648604768312*^9, {3.934648652541504*^9, 3.934648687894021*^9}, {
   3.934649781686335*^9, 3.934649806079066*^9}, 3.934649920976519*^9, {
   3.934650010234178*^9, 3.9346500566047707`*^9}, {3.93465018788309*^9, 
   3.934650235698914*^9}, 3.9346502761221848`*^9, {3.934650312771174*^9, 
   3.934650324321582*^9}, 3.934650392075851*^9, {3.934650917067885*^9, 
   3.93465095314*^9}, 3.934650993455058*^9, 3.9346510917050047`*^9, 
   3.93465291394914*^9, {3.934653034530128*^9, 3.9346530469315557`*^9}, 
   3.9346530880541077`*^9, 3.9346531464693947`*^9, {3.9346531832098*^9, 
   3.9346532020421543`*^9}, 3.934653570126968*^9, {3.934662679921269*^9, 
   3.9346627018114853`*^9}, 3.934662738552721*^9, {3.934662876896356*^9, 
   3.934662887141284*^9}, {3.934662931005734*^9, 3.934662956845251*^9}, 
   3.935240740498039*^9, {3.935240791356477*^9, 3.9352408064694023`*^9}, {
   3.935241046530495*^9, 3.935241068145925*^9}, 3.935250341241066*^9, 
   3.935250383404915*^9, {3.9352506001479993`*^9, 3.935250627655177*^9}, 
   3.935250743519598*^9, 3.936029048147219*^9, {3.936029479630287*^9, 
   3.936029483067447*^9}, 3.936029527617996*^9, 3.9360311072127438`*^9, 
   3.9360328550389357`*^9, 3.936033520725393*^9, 3.93603399073104*^9, 
   3.936034031866658*^9, 3.936034085284671*^9, 3.93603421348031*^9, {
   3.936034462060647*^9, 3.936034472147016*^9}, 3.9360347887682247`*^9, 
   3.936034884311159*^9, 3.93603498250981*^9, {3.936194185919437*^9, 
   3.936194203029585*^9}, 3.936357198969326*^9, 3.936362378915915*^9, 
   3.936379182969203*^9, {3.936379336732615*^9, 3.936379360445992*^9}, 
   3.936379534076734*^9},
 CellLabel->
  "During evaluation of \
In[798]:=",ExpressionUUID->"2934d6b6-81d2-4ffb-844d-6db2c0ff7ee3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"6", " ", "r", " ", 
      RowBox[{"Cos", "[", "p", "]"}], " ", 
      RowBox[{"Sin", "[", "t", "]"}]}], ",", 
     RowBox[{"2", " ", "r", " ", 
      RowBox[{"Sin", "[", "p", "]"}], " ", 
      RowBox[{"Sin", "[", "t", "]"}]}], ",", 
     RowBox[{"2", " ", "r", " ", 
      RowBox[{"Cos", "[", "t", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", "r", " ", 
      RowBox[{"Sin", "[", "p", "]"}], " ", 
      RowBox[{"Sin", "[", "t", "]"}]}], ",", 
     RowBox[{"2", " ", "r", " ", 
      RowBox[{"Cos", "[", "p", "]"}], " ", 
      RowBox[{"Sin", "[", "t", "]"}]}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"2", " ", "r", " ", 
      RowBox[{"Cos", "[", "t", "]"}]}], ",", "0", ",", 
     RowBox[{"2", " ", "r", " ", 
      RowBox[{"Cos", "[", "p", "]"}], " ", 
      RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.934561366795213*^9, 3.93456143718443*^9, {3.9345617840011044`*^9, 
   3.934561792302905*^9}, {3.934562411062694*^9, 3.934562432884573*^9}, 
   3.934562540588208*^9, {3.934562575279674*^9, 3.934562585317964*^9}, 
   3.934635180131947*^9, 3.934642120929764*^9, 3.934642920526026*^9, 
   3.934643443433602*^9, 3.934643778091479*^9, 3.9346439813171*^9, 
   3.934644030244637*^9, 3.934644069612084*^9, 3.934644127421257*^9, {
   3.934644910048142*^9, 3.934644949455341*^9}, {3.934644989134675*^9, 
   3.934645032827955*^9}, 3.934645085325982*^9, 3.934645292561574*^9, 
   3.934645771381077*^9, 3.934646481393003*^9, 3.934646750884302*^9, 
   3.934646816062078*^9, 3.934646861688303*^9, {3.9346469014863358`*^9, 
   3.934646928243171*^9}, {3.9346469613375807`*^9, 3.934646986971951*^9}, {
   3.93464708621241*^9, 3.9346471121023483`*^9}, 3.934647150501734*^9, {
   3.934647182912912*^9, 3.934647186359703*^9}, {3.934647457862175*^9, 
   3.934647625779133*^9}, 3.934647687483698*^9, {3.934647720022428*^9, 
   3.934647726187817*^9}, {3.934647775189315*^9, 3.9346477960846157`*^9}, 
   3.934647845685845*^9, {3.934647893379798*^9, 3.934647905961093*^9}, {
   3.934647965745398*^9, 3.93464799042232*^9}, {3.934648065388516*^9, 
   3.934648164380046*^9}, 3.934648200274085*^9, 3.934648266342901*^9, 
   3.934648318760189*^9, 3.934648604769577*^9, {3.934648652542721*^9, 
   3.934648687895195*^9}, {3.934649781687509*^9, 3.934649806080364*^9}, 
   3.93464992097771*^9, {3.934650010235275*^9, 3.934650056605849*^9}, {
   3.934650187884338*^9, 3.934650235699989*^9}, 3.934650276123374*^9, {
   3.934650312772275*^9, 3.934650324322674*^9}, 3.934650392076933*^9, {
   3.934650917069077*^9, 3.934650953141036*^9}, 3.934650993456414*^9, 
   3.9346510917060623`*^9, 3.934652913950248*^9, {3.934653034531282*^9, 
   3.934653046932794*^9}, 3.934653088055225*^9, 3.934653146470546*^9, {
   3.934653183210965*^9, 3.9346532020432777`*^9}, 3.9346535701281*^9, {
   3.934662679973946*^9, 3.9346627018125*^9}, 3.934662738554541*^9, {
   3.934662876896912*^9, 3.934662887143652*^9}, {3.934662931006379*^9, 
   3.934662956845815*^9}, 3.9352407405242577`*^9, {3.935240791357108*^9, 
   3.935240806469895*^9}, {3.935241046531017*^9, 3.93524106814644*^9}, 
   3.935250341276455*^9, 3.935250383405522*^9, {3.935250600148654*^9, 
   3.935250627660886*^9}, 3.935250743520183*^9, 3.936029048210071*^9, {
   3.936029479650715*^9, 3.936029483068028*^9}, 3.936029527618685*^9, 
   3.936031107233344*^9, 3.9360328550395203`*^9, 3.936033520725968*^9, 
   3.9360339907315474`*^9, 3.936034031867193*^9, 3.936034085285186*^9, 
   3.9360342134808187`*^9, {3.936034462061247*^9, 3.936034472147532*^9}, 
   3.936034788768738*^9, 3.936034884311676*^9, 3.936034982510338*^9, {
   3.936194185961627*^9, 3.936194203030558*^9}, 3.936357199014501*^9, 
   3.936362378954946*^9, 3.936379182970586*^9, {3.9363793367335157`*^9, 
   3.936379360448197*^9}, 3.936379534078125*^9},
 CellLabel->
  "Out[834]=",ExpressionUUID->"1a289ed0-9bea-4d74-9de4-219d8a4b2538"],

Cell[BoxData["\<\"Contraction: \"\>"], "Print",
 CellChangeTimes->{{3.934647523419259*^9, 3.934647625778064*^9}, 
   3.934647687482502*^9, {3.934647720021162*^9, 3.934647726186639*^9}, {
   3.934647775188197*^9, 3.934647796083047*^9}, 3.934647845684391*^9, {
   3.934647893378641*^9, 3.934647905959881*^9}, {3.934647965744204*^9, 
   3.934647990421006*^9}, {3.9346480653873*^9, 3.934648164378627*^9}, 
   3.9346482002729588`*^9, 3.9346482663416147`*^9, 3.934648318758972*^9, 
   3.934648604768312*^9, {3.934648652541504*^9, 3.934648687894021*^9}, {
   3.934649781686335*^9, 3.934649806079066*^9}, 3.934649920976519*^9, {
   3.934650010234178*^9, 3.9346500566047707`*^9}, {3.93465018788309*^9, 
   3.934650235698914*^9}, 3.9346502761221848`*^9, {3.934650312771174*^9, 
   3.934650324321582*^9}, 3.934650392075851*^9, {3.934650917067885*^9, 
   3.93465095314*^9}, 3.934650993455058*^9, 3.9346510917050047`*^9, 
   3.93465291394914*^9, {3.934653034530128*^9, 3.9346530469315557`*^9}, 
   3.9346530880541077`*^9, 3.9346531464693947`*^9, {3.9346531832098*^9, 
   3.9346532020421543`*^9}, 3.934653570126968*^9, {3.934662679921269*^9, 
   3.9346627018114853`*^9}, 3.934662738552721*^9, {3.934662876896356*^9, 
   3.934662887141284*^9}, {3.934662931005734*^9, 3.934662956845251*^9}, 
   3.935240740498039*^9, {3.935240791356477*^9, 3.9352408064694023`*^9}, {
   3.935241046530495*^9, 3.935241068145925*^9}, 3.935250341241066*^9, 
   3.935250383404915*^9, {3.9352506001479993`*^9, 3.935250627655177*^9}, 
   3.935250743519598*^9, 3.936029048147219*^9, {3.936029479630287*^9, 
   3.936029483067447*^9}, 3.936029527617996*^9, 3.9360311072127438`*^9, 
   3.9360328550389357`*^9, 3.936033520725393*^9, 3.93603399073104*^9, 
   3.936034031866658*^9, 3.936034085284671*^9, 3.93603421348031*^9, {
   3.936034462060647*^9, 3.936034472147016*^9}, 3.9360347887682247`*^9, 
   3.936034884311159*^9, 3.93603498250981*^9, {3.936194185919437*^9, 
   3.936194203029585*^9}, 3.936357198969326*^9, 3.936362378915915*^9, 
   3.936379182969203*^9, {3.936379336732615*^9, 3.936379360445992*^9}, 
   3.936379534079032*^9},
 CellLabel->
  "During evaluation of \
In[798]:=",ExpressionUUID->"3e2d107c-d470-4c89-bb52-a89eec1a1bf1"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2.`", " ", "rp", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "pp", "]"}], "3"], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
       RowBox[{"4.`", " ", "rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "pp", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
       RowBox[{"6.`", " ", "rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "tp", "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "pp", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
       RowBox[{"6.`", " ", "rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "pp", "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "tp", "]"}], "3"]}], "+", 
       RowBox[{"2.`", " ", "rq", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "pq", "]"}], "3"], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}], "-", 
       RowBox[{"4.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "pq", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}], "+", 
       RowBox[{"6.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "tq", "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "pq", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}], "+", 
       RowBox[{"6.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "pq", "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "tq", "]"}], "3"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "tq", "]"}]}]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], "2"]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"6.`", " ", "rp", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "pp", "]"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "tp", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
       RowBox[{"6.`", " ", "rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "pp", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
       RowBox[{"6.`", " ", "rp", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "pp", "]"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "tp", "]"}], "3"]}], "+", 
       RowBox[{"6.`", " ", "rq", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "pq", "]"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "tq", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}], "+", 
       RowBox[{"6.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "pq", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}], "+", 
       RowBox[{"6.`", " ", "rq", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "pq", "]"}], "3"], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "tq", "]"}], "3"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "tq", "]"}]}]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Sin", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Sin", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], "2"]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2.`", " ", "rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "tp", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
       RowBox[{"2.`", " ", "rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "tp", "]"}], "3"]}], "+", 
       RowBox[{"2.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "tq", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}], "+", 
       RowBox[{"2.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "tq", "]"}], "3"]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Sin", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Sin", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], "2"]}], ")"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
       RowBox[{"rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rp", " ", 
        RowBox[{"Sin", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
       RowBox[{"rq", " ", 
        RowBox[{"Sin", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2.`"}], " ", "rp", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "pp", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
       RowBox[{"6.`", " ", "rp", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "pp", "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "tp", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
       RowBox[{"6.`", " ", "rp", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "pp", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "pp", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "tp", "]"}], "3"]}], "-", 
       RowBox[{"2.`", " ", "rp", " ", 
        RowBox[{"Sin", "[", "pp", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "pp", "]"}], "2"], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"1.`", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "pp", "]"}], "2"], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}]}], ")"}]}], "-", 
       RowBox[{"2.`", " ", "rq", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "pq", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}], "+", 
       RowBox[{"6.`", " ", "rq", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "pq", "]"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "tq", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}], "+", 
       RowBox[{"6.`", " ", "rq", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "pq", "]"}], "2"], " ", 
        RowBox[{"Sin", "[", "pq", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "tq", "]"}], "3"]}], "-", 
       RowBox[{"2.`", " ", "rq", " ", 
        RowBox[{"Sin", "[", "pq", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "pq", "]"}], "2"], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}], "-", 
          RowBox[{"1.`", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "pq", "]"}], "2"], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}]}]}], ")"}]}], "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rp", " ", 
        RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
       RowBox[{"rq", " ", 
        RowBox[{"Cos", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
       RowBox[{"rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2.`", " ", "rp", " ", 
        RowBox[{"Cos", "[", "tp", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "pp", "]"}], "2"]}], "+", 
       RowBox[{"2.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "tq", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "pq", "]"}], "2"]}], "+", 
       RowBox[{"4.`", " ", "rp", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "pp", "]"}], "2"], " ", 
        RowBox[{"Cos", "[", "tp", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "tp", "]"}], "2"]}], "+", 
       RowBox[{"2.`", " ", "rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        RowBox[{"Cos", "[", "tp", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "pp", "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "tp", "]"}], "2"]}], "-", 
          RowBox[{"1.`", " ", 
           RowBox[{"Cos", "[", "pp", "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "tp", "]"}], "2"]}]}], ")"}]}], "+", 
       RowBox[{"4.`", " ", "rq", " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "pq", "]"}], "2"], " ", 
        RowBox[{"Cos", "[", "tq", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "tq", "]"}], "2"]}], "+", 
       RowBox[{"2.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        RowBox[{"Cos", "[", "tq", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", "pq", "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "tq", "]"}], "2"]}], "-", 
          RowBox[{"1.`", " ", 
           RowBox[{"Cos", "[", "pq", "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "tq", "]"}], "2"]}]}], ")"}]}]}], ")"}]}], 
    "-", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rp", " ", 
        RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
       RowBox[{"rq", " ", 
        RowBox[{"Cos", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rp", " ", 
        RowBox[{"Sin", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
       RowBox[{"rq", " ", 
        RowBox[{"Sin", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2.`"}], " ", "rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        RowBox[{"Cos", "[", "tp", "]"}], " ", 
        RowBox[{"Sin", "[", "pp", "]"}]}], "-", 
       RowBox[{"2.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        RowBox[{"Cos", "[", "tq", "]"}], " ", 
        RowBox[{"Sin", "[", "pq", "]"}]}], "+", 
       RowBox[{"4.`", " ", "rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        RowBox[{"Cos", "[", "tp", "]"}], " ", 
        RowBox[{"Sin", "[", "pp", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "tp", "]"}], "2"]}], "+", 
       RowBox[{"2.`", " ", "rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        RowBox[{"Cos", "[", "tp", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "tp", "]"}], "2"], " ", 
           RowBox[{"Sin", "[", "pp", "]"}]}], "-", 
          RowBox[{"1.`", " ", 
           RowBox[{"Sin", "[", "pp", "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "tp", "]"}], "2"]}]}], ")"}]}], "+", 
       RowBox[{"4.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        RowBox[{"Cos", "[", "tq", "]"}], " ", 
        RowBox[{"Sin", "[", "pq", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "tq", "]"}], "2"]}], "+", 
       RowBox[{"2.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        RowBox[{"Cos", "[", "tq", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "tq", "]"}], "2"], " ", 
           RowBox[{"Sin", "[", "pq", "]"}]}], "-", 
          RowBox[{"1.`", " ", 
           RowBox[{"Sin", "[", "pq", "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "tq", "]"}], "2"]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.934561366795213*^9, 3.93456143718443*^9, {3.9345617840011044`*^9, 
   3.934561792302905*^9}, {3.934562411062694*^9, 3.934562432884573*^9}, 
   3.934562540588208*^9, {3.934562575279674*^9, 3.934562585317964*^9}, 
   3.934635180131947*^9, 3.934642120929764*^9, 3.934642920526026*^9, 
   3.934643443433602*^9, 3.934643778091479*^9, 3.9346439813171*^9, 
   3.934644030244637*^9, 3.934644069612084*^9, 3.934644127421257*^9, {
   3.934644910048142*^9, 3.934644949455341*^9}, {3.934644989134675*^9, 
   3.934645032827955*^9}, 3.934645085325982*^9, 3.934645292561574*^9, 
   3.934645771381077*^9, 3.934646481393003*^9, 3.934646750884302*^9, 
   3.934646816062078*^9, 3.934646861688303*^9, {3.9346469014863358`*^9, 
   3.934646928243171*^9}, {3.9346469613375807`*^9, 3.934646986971951*^9}, {
   3.93464708621241*^9, 3.9346471121023483`*^9}, 3.934647150501734*^9, {
   3.934647182912912*^9, 3.934647186359703*^9}, {3.934647457862175*^9, 
   3.934647625779133*^9}, 3.934647687483698*^9, {3.934647720022428*^9, 
   3.934647726187817*^9}, {3.934647775189315*^9, 3.9346477960846157`*^9}, 
   3.934647845685845*^9, {3.934647893379798*^9, 3.934647905961093*^9}, {
   3.934647965745398*^9, 3.93464799042232*^9}, {3.934648065388516*^9, 
   3.934648164380046*^9}, 3.934648200274085*^9, 3.934648266342901*^9, 
   3.934648318760189*^9, 3.934648604769577*^9, {3.934648652542721*^9, 
   3.934648687895195*^9}, {3.934649781687509*^9, 3.934649806080364*^9}, 
   3.93464992097771*^9, {3.934650010235275*^9, 3.934650056605849*^9}, {
   3.934650187884338*^9, 3.934650235699989*^9}, 3.934650276123374*^9, {
   3.934650312772275*^9, 3.934650324322674*^9}, 3.934650392076933*^9, {
   3.934650917069077*^9, 3.934650953141036*^9}, 3.934650993456414*^9, 
   3.9346510917060623`*^9, 3.934652913950248*^9, {3.934653034531282*^9, 
   3.934653046932794*^9}, 3.934653088055225*^9, 3.934653146470546*^9, {
   3.934653183210965*^9, 3.9346532020432777`*^9}, 3.9346535701281*^9, {
   3.934662679973946*^9, 3.9346627018125*^9}, 3.934662738554541*^9, {
   3.934662876896912*^9, 3.934662887143652*^9}, {3.934662931006379*^9, 
   3.934662956845815*^9}, 3.9352407405242577`*^9, {3.935240791357108*^9, 
   3.935240806469895*^9}, {3.935241046531017*^9, 3.93524106814644*^9}, 
   3.935250341276455*^9, 3.935250383405522*^9, {3.935250600148654*^9, 
   3.935250627660886*^9}, 3.935250743520183*^9, 3.936029048210071*^9, {
   3.936029479650715*^9, 3.936029483068028*^9}, 3.936029527618685*^9, 
   3.936031107233344*^9, 3.9360328550395203`*^9, 3.936033520725968*^9, 
   3.9360339907315474`*^9, 3.936034031867193*^9, 3.936034085285186*^9, 
   3.9360342134808187`*^9, {3.936034462061247*^9, 3.936034472147532*^9}, 
   3.936034788768738*^9, 3.936034884311676*^9, 3.936034982510338*^9, {
   3.936194185961627*^9, 3.936194203030558*^9}, 3.936357199014501*^9, 
   3.936362378954946*^9, 3.936379182970586*^9, {3.9363793367335157`*^9, 
   3.936379360448197*^9}, 3.936379534081757*^9},
 CellLabel->
  "Out[838]=",ExpressionUUID->"8eba082f-3395-4a4f-8a9e-9d136dd69318"],

Cell[BoxData["\<\"Weight result: \"\>"], "Print",
 CellChangeTimes->{{3.934647523419259*^9, 3.934647625778064*^9}, 
   3.934647687482502*^9, {3.934647720021162*^9, 3.934647726186639*^9}, {
   3.934647775188197*^9, 3.934647796083047*^9}, 3.934647845684391*^9, {
   3.934647893378641*^9, 3.934647905959881*^9}, {3.934647965744204*^9, 
   3.934647990421006*^9}, {3.9346480653873*^9, 3.934648164378627*^9}, 
   3.9346482002729588`*^9, 3.9346482663416147`*^9, 3.934648318758972*^9, 
   3.934648604768312*^9, {3.934648652541504*^9, 3.934648687894021*^9}, {
   3.934649781686335*^9, 3.934649806079066*^9}, 3.934649920976519*^9, {
   3.934650010234178*^9, 3.9346500566047707`*^9}, {3.93465018788309*^9, 
   3.934650235698914*^9}, 3.9346502761221848`*^9, {3.934650312771174*^9, 
   3.934650324321582*^9}, 3.934650392075851*^9, {3.934650917067885*^9, 
   3.93465095314*^9}, 3.934650993455058*^9, 3.9346510917050047`*^9, 
   3.93465291394914*^9, {3.934653034530128*^9, 3.9346530469315557`*^9}, 
   3.9346530880541077`*^9, 3.9346531464693947`*^9, {3.9346531832098*^9, 
   3.9346532020421543`*^9}, 3.934653570126968*^9, {3.934662679921269*^9, 
   3.9346627018114853`*^9}, 3.934662738552721*^9, {3.934662876896356*^9, 
   3.934662887141284*^9}, {3.934662931005734*^9, 3.934662956845251*^9}, 
   3.935240740498039*^9, {3.935240791356477*^9, 3.9352408064694023`*^9}, {
   3.935241046530495*^9, 3.935241068145925*^9}, 3.935250341241066*^9, 
   3.935250383404915*^9, {3.9352506001479993`*^9, 3.935250627655177*^9}, 
   3.935250743519598*^9, 3.936029048147219*^9, {3.936029479630287*^9, 
   3.936029483067447*^9}, 3.936029527617996*^9, 3.9360311072127438`*^9, 
   3.9360328550389357`*^9, 3.936033520725393*^9, 3.93603399073104*^9, 
   3.936034031866658*^9, 3.936034085284671*^9, 3.93603421348031*^9, {
   3.936034462060647*^9, 3.936034472147016*^9}, 3.9360347887682247`*^9, 
   3.936034884311159*^9, 3.93603498250981*^9, {3.936194185919437*^9, 
   3.936194203029585*^9}, 3.936357198969326*^9, 3.936362378915915*^9, 
   3.936379182969203*^9, {3.936379336732615*^9, 3.936379360445992*^9}, 
   3.936379534084401*^9},
 CellLabel->
  "During evaluation of \
In[798]:=",ExpressionUUID->"092de6f2-5b97-4599-a5be-0241477d94fa"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"rp", " ", 
     RowBox[{"Cos", "[", "pp", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4.`"}], " ", 
        SuperscriptBox["rp", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "tp", "]"}], "2"]}], "+", 
       RowBox[{"4.`", " ", 
        SuperscriptBox["rq", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "tq", "]"}], "2"]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
    RowBox[{"rq", " ", 
     RowBox[{"Cos", "[", "pq", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4.`", " ", 
        SuperscriptBox["rp", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "tp", "]"}], "2"]}], "-", 
       RowBox[{"4.`", " ", 
        SuperscriptBox["rq", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "tq", "]"}], "2"]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "tq", "]"}]}], "-", 
    RowBox[{"12.`", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
       RowBox[{"1.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rp", " ", 
        RowBox[{"Sin", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
       RowBox[{"1.`", " ", "rq", " ", 
        RowBox[{"Sin", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rp", " ", 
        RowBox[{"(", 
         RowBox[{"0.33333333333333337`", "\[VeryThinSpace]", "+", 
          RowBox[{"4.163336342344337`*^-17", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "pp", "]"}], "2"]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
       RowBox[{"1.3877787807814457`*^-17", " ", "rp", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "pp", "]"}], "3"], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
       RowBox[{"rq", " ", 
        RowBox[{"Sin", "[", "pq", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"0.33333333333333337`", "\[VeryThinSpace]", "+", 
          RowBox[{"4.163336342344337`*^-17", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "pq", "]"}], "2"]}], "-", 
          RowBox[{"1.3877787807814457`*^-17", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "pq", "]"}], "2"]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2.`", " ", "rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
       RowBox[{"2.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "tq", "]"}]}]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], "2"]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"6.`", " ", "rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
       RowBox[{"6.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "tq", "]"}]}]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Sin", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Sin", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], "2"]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2.`", " ", "rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
       RowBox[{"2.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Sin", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Sin", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], "2"]}], ")"}]}], "-", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "pp", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2.5`"}], "+", 
             RowBox[{"2.`", " ", 
              SuperscriptBox["rp", "2"]}], "-", 
             RowBox[{"1.`", " ", 
              SuperscriptBox["rp", "2"], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2.`", " ", "tp"}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "pq", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{"2.5`", "\[VeryThinSpace]", "-", 
             RowBox[{"2.`", " ", 
              SuperscriptBox["rq", "2"]}], "+", 
             RowBox[{"1.`", " ", 
              SuperscriptBox["rq", "2"], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2.`", " ", "tq"}], "]"}]}]}], ")"}]}], "-", 
          RowBox[{"2.5`", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "pp", "]"}], "2"]}], "+", 
          RowBox[{"1.`", " ", 
           SuperscriptBox["rp", "2"], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "pp", "]"}], "2"]}], "+", 
          RowBox[{"2.5`", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "pq", "]"}], "2"]}], "-", 
          RowBox[{"1.`", " ", 
           SuperscriptBox["rq", "2"], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "pq", "]"}], "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Sin", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Sin", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["rp", "2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2.`", " ", "pp"}], "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "tp", "]"}], "2"]}], "-", 
          RowBox[{
           SuperscriptBox["rq", "2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2.`", " ", "pq"}], "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "tq", "]"}], "2"]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "tq", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["rp", "2"], " ", 
           RowBox[{"Cos", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2.`", " ", "tp"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["rq", "2"], " ", 
           RowBox[{"Cos", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2.`", " ", "tq"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.934561366795213*^9, 3.93456143718443*^9, {3.9345617840011044`*^9, 
   3.934561792302905*^9}, {3.934562411062694*^9, 3.934562432884573*^9}, 
   3.934562540588208*^9, {3.934562575279674*^9, 3.934562585317964*^9}, 
   3.934635180131947*^9, 3.934642120929764*^9, 3.934642920526026*^9, 
   3.934643443433602*^9, 3.934643778091479*^9, 3.9346439813171*^9, 
   3.934644030244637*^9, 3.934644069612084*^9, 3.934644127421257*^9, {
   3.934644910048142*^9, 3.934644949455341*^9}, {3.934644989134675*^9, 
   3.934645032827955*^9}, 3.934645085325982*^9, 3.934645292561574*^9, 
   3.934645771381077*^9, 3.934646481393003*^9, 3.934646750884302*^9, 
   3.934646816062078*^9, 3.934646861688303*^9, {3.9346469014863358`*^9, 
   3.934646928243171*^9}, {3.9346469613375807`*^9, 3.934646986971951*^9}, {
   3.93464708621241*^9, 3.9346471121023483`*^9}, 3.934647150501734*^9, {
   3.934647182912912*^9, 3.934647186359703*^9}, {3.934647457862175*^9, 
   3.934647625779133*^9}, 3.934647687483698*^9, {3.934647720022428*^9, 
   3.934647726187817*^9}, {3.934647775189315*^9, 3.9346477960846157`*^9}, 
   3.934647845685845*^9, {3.934647893379798*^9, 3.934647905961093*^9}, {
   3.934647965745398*^9, 3.93464799042232*^9}, {3.934648065388516*^9, 
   3.934648164380046*^9}, 3.934648200274085*^9, 3.934648266342901*^9, 
   3.934648318760189*^9, 3.934648604769577*^9, {3.934648652542721*^9, 
   3.934648687895195*^9}, {3.934649781687509*^9, 3.934649806080364*^9}, 
   3.93464992097771*^9, {3.934650010235275*^9, 3.934650056605849*^9}, {
   3.934650187884338*^9, 3.934650235699989*^9}, 3.934650276123374*^9, {
   3.934650312772275*^9, 3.934650324322674*^9}, 3.934650392076933*^9, {
   3.934650917069077*^9, 3.934650953141036*^9}, 3.934650993456414*^9, 
   3.9346510917060623`*^9, 3.934652913950248*^9, {3.934653034531282*^9, 
   3.934653046932794*^9}, 3.934653088055225*^9, 3.934653146470546*^9, {
   3.934653183210965*^9, 3.9346532020432777`*^9}, 3.9346535701281*^9, {
   3.934662679973946*^9, 3.9346627018125*^9}, 3.934662738554541*^9, {
   3.934662876896912*^9, 3.934662887143652*^9}, {3.934662931006379*^9, 
   3.934662956845815*^9}, 3.9352407405242577`*^9, {3.935240791357108*^9, 
   3.935240806469895*^9}, {3.935241046531017*^9, 3.93524106814644*^9}, 
   3.935250341276455*^9, 3.935250383405522*^9, {3.935250600148654*^9, 
   3.935250627660886*^9}, 3.935250743520183*^9, 3.936029048210071*^9, {
   3.936029479650715*^9, 3.936029483068028*^9}, 3.936029527618685*^9, 
   3.936031107233344*^9, 3.9360328550395203`*^9, 3.936033520725968*^9, 
   3.9360339907315474`*^9, 3.936034031867193*^9, 3.936034085285186*^9, 
   3.9360342134808187`*^9, {3.936034462061247*^9, 3.936034472147532*^9}, 
   3.936034788768738*^9, 3.936034884311676*^9, 3.936034982510338*^9, {
   3.936194185961627*^9, 3.936194203030558*^9}, 3.936357199014501*^9, 
   3.936362378954946*^9, 3.936379182970586*^9, {3.9363793367335157`*^9, 
   3.936379360448197*^9}, 3.936379535879245*^9},
 CellLabel->
  "Out[840]=",ExpressionUUID->"50f380ba-f7ea-4136-b896-79a397143eda"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pol", " ", "=", " ", 
  RowBox[{"rp", "*", 
   RowBox[{"(", 
    RowBox[{"2.5", " ", "-", 
     RowBox[{"rp", "^", "2"}]}], ")"}], 
   RowBox[{"Cos", "[", "pp", "]"}], "*", 
   RowBox[{"Sin", "[", "tp", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"f", " ", "=", " ", 
  RowBox[{
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"rp", "^", "2"}]}], "/", "2"}], "]"}], 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"rq", "^", "2"}]}], "/", "2"}], "]"}], "*", " ", 
   RowBox[{"rp", "^", "2"}], "*", " ", 
   RowBox[{"rq", "^", "2"}], " ", "*", 
   RowBox[{"Sin", "[", "tp", "]"}], "*", 
   RowBox[{"Sin", "[", "tq", "]"}], "*", " ", "pol", "*", 
   "weight"}]}]}], "Input",
 CellChangeTimes->{{3.934550480787641*^9, 3.9345504814384*^9}, {
   3.9345613496998587`*^9, 3.934561350725933*^9}, {3.9345625525631933`*^9, 
   3.934562561262026*^9}, {3.934646407070944*^9, 3.934646472571828*^9}, {
   3.934646547619327*^9, 3.934646547874242*^9}, {3.934646621048822*^9, 
   3.9346466272254763`*^9}, {3.93464667536561*^9, 3.934646676349175*^9}, 
   3.934646853136837*^9, 3.934646891454494*^9, {3.936194288145005*^9, 
   3.936194290661074*^9}, {3.936194439533449*^9, 3.936194545367734*^9}, {
   3.936194769979611*^9, 3.936194788385536*^9}, {3.936357256286653*^9, 
   3.93635728452681*^9}, {3.936361075387594*^9, 3.936361095040785*^9}, {
   3.93636240729084*^9, 3.936362412404407*^9}, {3.936363170222807*^9, 
   3.936363218328611*^9}, {3.9363792024046383`*^9, 3.936379202680491*^9}, {
   3.936379381446377*^9, 3.9363793995427713`*^9}, {3.936379561453631*^9, 
   3.936379584505459*^9}, {3.9363796229353323`*^9, 3.936379624268724*^9}, 
   3.936379781932379*^9},
 CellLabel->
  "In[844]:=",ExpressionUUID->"37c35491-c116-4a47-88f3-4c0787afe9f5"],

Cell[BoxData[
 RowBox[{"rp", " ", 
  RowBox[{"(", 
   RowBox[{"2.5`", "\[VeryThinSpace]", "-", 
    SuperscriptBox["rp", "2"]}], ")"}], " ", 
  RowBox[{"Cos", "[", "pp", "]"}], " ", 
  RowBox[{"Sin", "[", "tp", "]"}]}]], "Output",
 CellChangeTimes->{
  3.936361105904818*^9, 3.936362413825543*^9, 3.936363222423167*^9, 
   3.936379204574569*^9, {3.936379400981698*^9, 3.936379411189906*^9}, 
   3.936379628161065*^9, 3.936379793901305*^9},
 CellLabel->
  "Out[844]=",ExpressionUUID->"4a55ed4d-da04-4190-8ac3-5d79c626c7db"],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", 
  SuperscriptBox["\[ExponentialE]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      SuperscriptBox["rp", "2"], "2"]}], "-", 
    FractionBox[
     SuperscriptBox["rq", "2"], "2"]}]], " ", 
  SuperscriptBox["rp", "3"], " ", 
  RowBox[{"(", 
   RowBox[{"2.5`", "\[VeryThinSpace]", "-", 
    SuperscriptBox["rp", "2"]}], ")"}], " ", 
  SuperscriptBox["rq", "2"], " ", 
  RowBox[{"Cos", "[", "pp", "]"}], " ", 
  SuperscriptBox[
   RowBox[{"Sin", "[", "tp", "]"}], "2"], " ", 
  RowBox[{"Sin", "[", "tq", "]"}], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"rp", " ", 
     RowBox[{"Cos", "[", "pp", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4.`"}], " ", 
        SuperscriptBox["rp", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "tp", "]"}], "2"]}], "+", 
       RowBox[{"4.`", " ", 
        SuperscriptBox["rq", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "tq", "]"}], "2"]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
    RowBox[{"rq", " ", 
     RowBox[{"Cos", "[", "pq", "]"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4.`", " ", 
        SuperscriptBox["rp", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "tp", "]"}], "2"]}], "-", 
       RowBox[{"4.`", " ", 
        SuperscriptBox["rq", "2"], " ", 
        SuperscriptBox[
         RowBox[{"Cos", "[", "tq", "]"}], "2"]}]}], ")"}], " ", 
     RowBox[{"Sin", "[", "tq", "]"}]}], "-", 
    RowBox[{"12.`", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
       RowBox[{"1.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rp", " ", 
        RowBox[{"Sin", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
       RowBox[{"1.`", " ", "rq", " ", 
        RowBox[{"Sin", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"rp", " ", 
        RowBox[{"(", 
         RowBox[{"0.33333333333333337`", "\[VeryThinSpace]", "+", 
          RowBox[{"4.163336342344337`*^-17", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "pp", "]"}], "2"]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
       RowBox[{"1.3877787807814457`*^-17", " ", "rp", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", "pp", "]"}], "3"], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
       RowBox[{"rq", " ", 
        RowBox[{"Sin", "[", "pq", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{"0.33333333333333337`", "\[VeryThinSpace]", "+", 
          RowBox[{"4.163336342344337`*^-17", " ", 
           SuperscriptBox[
            RowBox[{"Cos", "[", "pq", "]"}], "2"]}], "-", 
          RowBox[{"1.3877787807814457`*^-17", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "pq", "]"}], "2"]}]}], ")"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2.`", " ", "rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
       RowBox[{"2.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "tq", "]"}]}]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], "2"]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"6.`", " ", "rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
       RowBox[{"6.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "tq", "]"}]}]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Sin", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Sin", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], "2"]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2.`", " ", "rp", " ", 
        RowBox[{"Cos", "[", "pp", "]"}], " ", 
        RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
       RowBox[{"2.`", " ", "rq", " ", 
        RowBox[{"Cos", "[", "pq", "]"}], " ", 
        RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Sin", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Sin", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], "2"]}], ")"}]}], "-", 
    RowBox[{"4", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "pp", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2.5`"}], "+", 
             RowBox[{"2.`", " ", 
              SuperscriptBox["rp", "2"]}], "-", 
             RowBox[{"1.`", " ", 
              SuperscriptBox["rp", "2"], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2.`", " ", "tp"}], "]"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"Cos", "[", "pq", "]"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{"2.5`", "\[VeryThinSpace]", "-", 
             RowBox[{"2.`", " ", 
              SuperscriptBox["rq", "2"]}], "+", 
             RowBox[{"1.`", " ", 
              SuperscriptBox["rq", "2"], " ", 
              RowBox[{"Cos", "[", 
               RowBox[{"2.`", " ", "tq"}], "]"}]}]}], ")"}]}], "-", 
          RowBox[{"2.5`", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "pp", "]"}], "2"]}], "+", 
          RowBox[{"1.`", " ", 
           SuperscriptBox["rp", "2"], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "pp", "]"}], "2"]}], "+", 
          RowBox[{"2.5`", " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "pq", "]"}], "2"]}], "-", 
          RowBox[{"1.`", " ", 
           SuperscriptBox["rq", "2"], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "pq", "]"}], "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Sin", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Sin", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["rp", "2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2.`", " ", "pp"}], "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "tp", "]"}], "2"]}], "-", 
          RowBox[{
           SuperscriptBox["rq", "2"], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2.`", " ", "pq"}], "]"}], " ", 
           SuperscriptBox[
            RowBox[{"Sin", "[", "tq", "]"}], "2"]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "tq", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SuperscriptBox["rp", "2"], " ", 
           RowBox[{"Cos", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2.`", " ", "tp"}], "]"}]}], "-", 
          RowBox[{
           SuperscriptBox["rq", "2"], " ", 
           RowBox[{"Cos", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{"2.`", " ", "tq"}], "]"}]}]}], ")"}]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.936361105904818*^9, 3.936362413825543*^9, 3.936363222423167*^9, 
   3.936379204574569*^9, {3.936379400981698*^9, 3.936379411189906*^9}, 
   3.936379628161065*^9, 3.9363797939036827`*^9},
 CellLabel->
  "Out[845]=",ExpressionUUID->"7b176ff0-f523-4bd7-b599-db3f6ca60378"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.936361029573369*^9, 
  3.936361069903296*^9}},ExpressionUUID->"b42f0e6d-a54a-4605-a35f-\
41a77a03f171"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.936362421927063*^9, 
  3.936362421931991*^9}},ExpressionUUID->"99327fe0-999b-458c-b935-\
95aef60a8631"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Integrate", "[", 
  RowBox[{"f", ",", " ", 
   RowBox[{"{", 
    RowBox[{"rp", ",", " ", "0", ",", " ", "Infinity"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"rq", ",", " ", "0", ",", " ", "Infinity"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"tp", ",", " ", "0", ",", " ", "Pi"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"tq", ",", " ", "0", ",", " ", "Pi"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"pp", ",", " ", "0", ",", " ", 
     RowBox[{"2", "Pi"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"pq", ",", " ", "0", ",", " ", 
     RowBox[{"2", "Pi"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.936194552759075*^9, 3.93619455491472*^9}, {
  3.936194618693345*^9, 3.936194710948797*^9}, {3.936357635011717*^9, 
  3.936357636181226*^9}, {3.936357718184032*^9, 3.936357720636222*^9}, {
  3.9363632467951097`*^9, 3.936363248268997*^9}},
 CellLabel->
  "In[846]:=",ExpressionUUID->"0ca220d8-1bdf-4070-8090-a9046f618138"],

Cell[BoxData[
 RowBox[{"9922.008537695932`", "\[VeryThinSpace]", "+", 
  RowBox[{"5.7327280053643275`*^-30", " ", "\[ImaginaryI]"}]}]], "Output",
 CellChangeTimes->{
  3.936194713057283*^9, {3.936194775634814*^9, 3.936194804752767*^9}, 
   3.936357304062769*^9, 3.936357641349524*^9, 3.936357725879136*^9, 
   3.936361117416151*^9, 3.936362434086567*^9, 3.936363255478579*^9, 
   3.936379230787426*^9, 3.936379427518117*^9, 3.9363797633173227`*^9, 
   3.9363798681503983`*^9},
 CellLabel->
  "Out[846]=",ExpressionUUID->"bd862644-d73e-4900-87c5-5bce31de8391"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "rp", ",", " ", "tp", ",", " ", "pp", ",", " ", "rq", ",", " ", "tq", ",", 
    " ", "pq"}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Basis", " ", "parameters"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Basis", " ", "function"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", " ", "=", " ", 
   RowBox[{"l", " ", "+", " ", 
    RowBox[{"1", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Test function:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"LaguerreL", "[", 
       RowBox[{"k", ",", " ", "a", " ", ",", " ", 
        RowBox[{"r", "^", "2"}]}], "]"}], 
      RowBox[{"r", "^", "l"}], "*", " ", 
      RowBox[{"LegendreP", "[", 
       RowBox[{"l", ",", 
        RowBox[{"Abs", "[", "m", "]"}], ",", " ", 
        RowBox[{"Cos", "[", "t", "]"}]}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{"m", " ", "p"}], "]"}]}], " ", ",", " ", 
     RowBox[{"Assumptions", "->", 
      RowBox[{
       RowBox[{"Sin", "[", "t", "]"}], ">", " ", "0"}]}]}], "]"}]}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "partials", " ", "for", " ", "the", " ", "gradient"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fr", "[", 
     RowBox[{"r_", " ", ",", "t_", ",", " ", "p_"}], "]"}], ":=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"s", ",", " ", "r"}], "]"}], "]"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ft", "[", 
    RowBox[{"r_", ",", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"s", ",", " ", "t"}], "]"}], "]"}], "/", "r"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fp", "[", 
     RowBox[{"r_", ",", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"s", ",", " ", "p"}], "]"}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"r", " ", 
       RowBox[{"Sin", "[", "t", "]"}]}], ")"}]}]}], ";"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "spherical", " ", "basis"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v1", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "t", "]"}], 
      RowBox[{"Cos", "[", "p", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Sin", "[", "t", "]"}], 
      RowBox[{"Sin", "[", "p", "]"}]}], ",", " ", 
     RowBox[{"Cos", "[", "t", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "t", "]"}], 
      RowBox[{"Cos", "[", "p", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Cos", "[", "t", "]"}], 
      RowBox[{"Sin", "[", "p", "]"}]}], ",", " ", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v3", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "p", "]"}]}], ",", " ", 
      RowBox[{"Cos", "[", "p", "]"}], ",", " ", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "computes", " ", "the", " ", "difference", " ", "in", " ", 
    "gradient"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Gradient: \>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fr", "[", 
     RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v1"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"ft", "[", 
     RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v2"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"fp", "[", 
     RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v3"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gradDiff", " ", "=", " ", 
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"fr", "[", 
             RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v1"}], " ", "+", " ", 
           
           RowBox[{
            RowBox[{"ft", "[", 
             RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v2"}], " ", "+", " ", 
           
           RowBox[{
            RowBox[{"fp", "[", 
             RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v3"}]}], "]"}], "/.", 
         
         RowBox[{"r", " ", "->", "  ", "rp"}]}], " ", "/.", " ", 
        RowBox[{"t", "->", " ", "tp"}]}], " ", "/.", 
       RowBox[{"p", " ", "->", " ", "pp"}]}], "]"}], " ", "-", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"fr", "[", 
             RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v1"}], " ", "+", " ", 
           
           RowBox[{
            RowBox[{"ft", "[", 
             RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v2"}], " ", "+", " ", 
           
           RowBox[{
            RowBox[{"fp", "[", 
             RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v3"}]}], "]"}], "/.", 
         
         RowBox[{"r", " ", "->", "rq"}]}], " ", "/.", " ", 
        RowBox[{"t", "->", " ", "tq"}]}], " ", "/.", 
       RowBox[{"p", " ", "->", " ", "pq"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Computes", " ", "relative", " ", "postition"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pos", " ", "=", " ", 
   RowBox[{"r", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"Cos", "[", "p", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"Sin", "[", "p", "]"}]}], ",", " ", 
      RowBox[{"Cos", "[", "t", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"relpos", " ", "=", " ", 
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pos", " ", "/.", 
         RowBox[{"r", " ", "->", "  ", "rp"}]}], " ", "/.", " ", 
        RowBox[{"t", "->", " ", "tp"}]}], " ", "/.", 
       RowBox[{"p", " ", "->", " ", "pp"}]}], "]"}], " ", "-", " ", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pos", " ", "/.", 
         RowBox[{"r", " ", "->", "  ", "rq"}]}], " ", "/.", " ", 
        RowBox[{"t", "->", " ", "tq"}]}], " ", "/.", 
       RowBox[{"p", " ", "->", " ", "pq"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Produce", " ", "the", " ", "projection", " ", "matrix"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proj", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], 
       RowBox[{"Dot", "[", 
        RowBox[{"relpos", ",", " ", "relpos"}], "]"}]}], "-", " ", 
      RowBox[{"Outer", "[", 
       RowBox[{"Times", ",", " ", "relpos", ",", " ", "relpos"}], "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"multiply", " ", "them"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<right hand vector: \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rh", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{"proj", ",", " ", "gradDiff"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"gradient", " ", "of", " ", "fq"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fq", " ", "=", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"r", "^", "2"}]}], "/", "2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "partials", " ", "for", " ", "the", " ", "gradient"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"frnew", "[", 
     RowBox[{"r_", " ", ",", "t_", ",", " ", "p_"}], "]"}], ":=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"fq", ",", " ", "r"}], "]"}], "]"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ftnew", "[", 
    RowBox[{"r_", ",", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"fq", ",", " ", "t"}], "]"}], "]"}], "/", "r"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fpnew", "[", 
     RowBox[{"r_", ",", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"fq", ",", " ", "p"}], "]"}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"r", " ", 
       RowBox[{"Sin", "[", "t", "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "gradient", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Gradient f : \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"gradf", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"frnew", "[", 
      RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v1"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"ftnew", "[", 
      RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v2"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"fpnew", "[", 
      RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v3"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gradfq", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"gradf", " ", "/.", 
        RowBox[{"r", " ", "->", "  ", "rq"}]}], " ", "/.", " ", 
       RowBox[{"t", "->", " ", "tq"}]}], " ", "/.", 
      RowBox[{"p", " ", "->", " ", "pq"}]}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"function", " ", "on", " ", "p"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<function on p\>\"", "]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"funcp", " ", "=", " ", 
   RowBox[{"rp", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", "/", "2"}], " ", "-", " ", 
      RowBox[{"rp", "^", "2"}]}], ")"}], "*", 
    RowBox[{"Cos", "[", "tp", "]"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "integrand", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<integrand: \>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"integrand", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"funcp", "*", "gradfq"}], ")"}], ",", " ", "rh"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", " ", "=", "  ", 
   RowBox[{
    RowBox[{"rp", "^", "2"}], "*", " ", 
    RowBox[{"rq", "^", "2"}], " ", "*", 
    RowBox[{"Sin", "[", "tp", "]"}], "*", 
    RowBox[{"Sin", "[", "tq", "]"}], "*", "integrand"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "integrate", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Integrate", "[", 
    RowBox[{"f", ",", " ", 
     RowBox[{"{", 
      RowBox[{"rp", ",", " ", "0", ",", " ", "Infinity"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"rq", ",", " ", "0", ",", " ", "Infinity"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"tp", ",", " ", "0", ",", " ", "Pi"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"tq", ",", " ", "0", ",", " ", "Pi"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"pp", ",", " ", "0", ",", " ", 
       RowBox[{"2", "Pi"}]}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"pq", ",", " ", "0", ",", " ", 
       RowBox[{"2", "Pi"}]}], "}"}]}], "]"}], 
   RowBox[{"Clear", "[", 
    RowBox[{
    "rp", ",", " ", "tp", ",", " ", "pp", ",", " ", "rq", ",", " ", "tq", ",",
      " ", "pq"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Basis", " ", "parameters"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Basis", " ", "function"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", " ", "=", " ", 
   RowBox[{"l", " ", "+", " ", 
    RowBox[{"1", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Test function:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"LaguerreL", "[", 
       RowBox[{"k", ",", " ", "a", " ", ",", " ", 
        RowBox[{"r", "^", "2"}]}], "]"}], 
      RowBox[{"r", "^", "l"}], "*", " ", 
      RowBox[{"LegendreP", "[", 
       RowBox[{"l", ",", 
        RowBox[{"Abs", "[", "m", "]"}], ",", " ", 
        RowBox[{"Cos", "[", "t", "]"}]}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{"m", " ", "p"}], "]"}]}], " ", ",", " ", 
     RowBox[{"Assumptions", "->", 
      RowBox[{
       RowBox[{"Sin", "[", "t", "]"}], ">", " ", "0"}]}]}], "]"}]}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "partials", " ", "for", " ", "the", " ", "gradient"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fr", "[", 
     RowBox[{"r_", " ", ",", "t_", ",", " ", "p_"}], "]"}], ":=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"s", ",", " ", "r"}], "]"}], "]"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ft", "[", 
    RowBox[{"r_", ",", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"s", ",", " ", "t"}], "]"}], "]"}], "/", "r"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fp", "[", 
     RowBox[{"r_", ",", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"s", ",", " ", "p"}], "]"}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"r", " ", 
       RowBox[{"Sin", "[", "t", "]"}]}], ")"}]}]}], ";"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "spherical", " ", "basis"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v1", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "t", "]"}], 
      RowBox[{"Cos", "[", "p", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Sin", "[", "t", "]"}], 
      RowBox[{"Sin", "[", "p", "]"}]}], ",", " ", 
     RowBox[{"Cos", "[", "t", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "t", "]"}], 
      RowBox[{"Cos", "[", "p", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Cos", "[", "t", "]"}], 
      RowBox[{"Sin", "[", "p", "]"}]}], ",", " ", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v3", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "p", "]"}]}], ",", " ", 
      RowBox[{"Cos", "[", "p", "]"}], ",", " ", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "computes", " ", "the", " ", "difference", " ", "in", " ", 
    "gradient"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Gradient: \>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fr", "[", 
     RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v1"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"ft", "[", 
     RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v2"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"fp", "[", 
     RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v3"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gradDiff", " ", "=", " ", 
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"fr", "[", 
             RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v1"}], " ", "+", " ", 
           
           RowBox[{
            RowBox[{"ft", "[", 
             RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v2"}], " ", "+", " ", 
           
           RowBox[{
            RowBox[{"fp", "[", 
             RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v3"}]}], "]"}], "/.", 
         
         RowBox[{"r", " ", "->", "  ", "rp"}]}], " ", "/.", " ", 
        RowBox[{"t", "->", " ", "tp"}]}], " ", "/.", 
       RowBox[{"p", " ", "->", " ", "pp"}]}], "]"}], " ", "-", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"Simplify", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"fr", "[", 
             RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v1"}], " ", "+", " ", 
           
           RowBox[{
            RowBox[{"ft", "[", 
             RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v2"}], " ", "+", " ", 
           
           RowBox[{
            RowBox[{"fp", "[", 
             RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v3"}]}], "]"}], "/.", 
         
         RowBox[{"r", " ", "->", "rq"}]}], " ", "/.", " ", 
        RowBox[{"t", "->", " ", "tq"}]}], " ", "/.", 
       RowBox[{"p", " ", "->", " ", "pq"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Computes", " ", "relative", " ", "postition"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pos", " ", "=", " ", 
   RowBox[{"r", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"Cos", "[", "p", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"Sin", "[", "p", "]"}]}], ",", " ", 
      RowBox[{"Cos", "[", "t", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"relpos", " ", "=", " ", 
    RowBox[{
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pos", " ", "/.", 
         RowBox[{"r", " ", "->", "  ", "rp"}]}], " ", "/.", " ", 
        RowBox[{"t", "->", " ", "tp"}]}], " ", "/.", 
       RowBox[{"p", " ", "->", " ", "pp"}]}], "]"}], " ", "-", " ", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"pos", " ", "/.", 
         RowBox[{"r", " ", "->", "  ", "rq"}]}], " ", "/.", " ", 
        RowBox[{"t", "->", " ", "tq"}]}], " ", "/.", 
       RowBox[{"p", " ", "->", " ", "pq"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Produce", " ", "the", " ", "projection", " ", "matrix"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"proj", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"IdentityMatrix", "[", "3", "]"}], 
       RowBox[{"Dot", "[", 
        RowBox[{"relpos", ",", " ", "relpos"}], "]"}]}], "-", " ", 
      RowBox[{"Outer", "[", 
       RowBox[{"Times", ",", " ", "relpos", ",", " ", "relpos"}], "]"}]}], 
     "]"}]}], ";"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"multiply", " ", "them"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<right hand vector: \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rh", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{"proj", ",", " ", "gradDiff"}], "]"}], "]"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"gradient", " ", "of", " ", "fq"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"fq", " ", "=", " ", 
    RowBox[{"Exp", "[", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"r", "^", "2"}]}], "/", "2"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "partials", " ", "for", " ", "the", " ", "gradient"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"frnew", "[", 
     RowBox[{"r_", " ", ",", "t_", ",", " ", "p_"}], "]"}], ":=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"fq", ",", " ", "r"}], "]"}], "]"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ftnew", "[", 
    RowBox[{"r_", ",", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"fq", ",", " ", "t"}], "]"}], "]"}], "/", "r"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fpnew", "[", 
     RowBox[{"r_", ",", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"fq", ",", " ", "p"}], "]"}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"r", " ", 
       RowBox[{"Sin", "[", "t", "]"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "gradient", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Gradient f : \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"gradf", " ", "=", " ", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"frnew", "[", 
      RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v1"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"ftnew", "[", 
      RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v2"}], " ", "+", " ", 
    RowBox[{
     RowBox[{"fpnew", "[", 
      RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v3"}]}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"gradfq", " ", "=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"gradf", " ", "/.", 
        RowBox[{"r", " ", "->", "  ", "rq"}]}], " ", "/.", " ", 
       RowBox[{"t", "->", " ", "tq"}]}], " ", "/.", 
      RowBox[{"p", " ", "->", " ", "pq"}]}], "]"}]}], ";"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"function", " ", "on", " ", "p"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<function on p\>\"", "]"}], "\[IndentingNewLine]", 

 RowBox[{
  RowBox[{"funcp", " ", "=", " ", 
   RowBox[{"rp", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"5", "/", "2"}], " ", "-", " ", 
      RowBox[{"rp", "^", "2"}]}], ")"}], "*", 
    RowBox[{"Cos", "[", "tp", "]"}]}]}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "integrand", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<integrand: \>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"integrand", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Dot", "[", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"funcp", "*", "gradfq"}], ")"}], ",", " ", "rh"}], "]"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"f", " ", "=", "  ", 
   RowBox[{
    RowBox[{"rp", "^", "2"}], "*", " ", 
    RowBox[{"rq", "^", "2"}], " ", "*", 
    RowBox[{"Sin", "[", "tp", "]"}], "*", 
    RowBox[{"Sin", "[", "tq", "]"}], "*", "integrand"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "integrate", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Integrate", "[", 
  RowBox[{"f", ",", " ", 
   RowBox[{"{", 
    RowBox[{"rp", ",", " ", "0", ",", " ", "Infinity"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"rq", ",", " ", "0", ",", " ", "Infinity"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"tp", ",", " ", "0", ",", " ", "Pi"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"tq", ",", " ", "0", ",", " ", "Pi"}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"pp", ",", " ", "0", ",", " ", 
     RowBox[{"2", "Pi"}]}], "}"}], ",", " ", 
   RowBox[{"{", 
    RowBox[{"pq", ",", " ", "0", ",", " ", 
     RowBox[{"2", "Pi"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{
  3.936379228745018*^9},ExpressionUUID->"06b597a2-7a7d-4bd7-b4bd-\
e846a5d0a253"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.936360998060336*^9, 
  3.936361000453105*^9}},ExpressionUUID->"f41a33d9-2e65-427f-85d9-\
a57f329bc01a"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{
   "rp", ",", " ", "tp", ",", " ", "pp", ",", " ", "rq", ",", " ", "tq", ",", 
    " ", "pq"}], "]"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Basis", " ", "parameters"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"k", " ", "=", " ", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"m", " ", "=", " ", "0"}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Basis", " ", "function"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"a", " ", "=", " ", 
   RowBox[{"l", " ", "+", " ", 
    RowBox[{"1", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Test function:\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"s", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"LaguerreL", "[", 
       RowBox[{"k", ",", " ", "a", " ", ",", " ", 
        RowBox[{"r", "^", "2"}]}], "]"}], 
      RowBox[{"r", "^", "l"}], "*", " ", 
      RowBox[{"LegendreP", "[", 
       RowBox[{"l", ",", 
        RowBox[{"Abs", "[", "m", "]"}], ",", " ", 
        RowBox[{"Cos", "[", "t", "]"}]}], "]"}], 
      RowBox[{"Cos", "[", 
       RowBox[{"m", " ", "p"}], "]"}]}], " ", ",", " ", 
     RowBox[{"Assumptions", "->", 
      RowBox[{
       RowBox[{"Sin", "[", "t", "]"}], ">", " ", "0"}]}]}], "]"}]}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "partials", " ", "for", " ", "the", " ", "gradient"}], 
   " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fr", "[", 
     RowBox[{"r_", " ", ",", "t_", ",", " ", "p_"}], "]"}], ":=", " ", 
    RowBox[{"Simplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"s", ",", " ", "r"}], "]"}], "]"}]}], ";"}], 
  "  "}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ft", "[", 
    RowBox[{"r_", ",", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"Simplify", "[", 
     RowBox[{"D", "[", 
      RowBox[{"s", ",", " ", "t"}], "]"}], "]"}], "/", "r"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"fp", "[", 
     RowBox[{"r_", ",", "t_", ",", " ", "p_"}], "]"}], " ", ":=", " ", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{"D", "[", 
       RowBox[{"s", ",", " ", "p"}], "]"}], "]"}], "/", 
     RowBox[{"(", 
      RowBox[{"r", " ", 
       RowBox[{"Sin", "[", "t", "]"}]}], ")"}]}]}], ";"}], " ", 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"the", " ", "spherical", " ", "basis"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v1", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", "t", "]"}], 
      RowBox[{"Cos", "[", "p", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Sin", "[", "t", "]"}], 
      RowBox[{"Sin", "[", "p", "]"}]}], ",", " ", 
     RowBox[{"Cos", "[", "t", "]"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"v2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Cos", "[", "t", "]"}], 
      RowBox[{"Cos", "[", "p", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Cos", "[", "t", "]"}], 
      RowBox[{"Sin", "[", "p", "]"}]}], ",", " ", 
     RowBox[{"-", 
      RowBox[{"Sin", "[", "t", "]"}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"v3", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"Sin", "[", "p", "]"}]}], ",", " ", 
      RowBox[{"Cos", "[", "p", "]"}], ",", " ", "0"}], "}"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{
   "This", " ", "computes", " ", "the", " ", "difference", " ", "in", " ", 
    "gradient"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Gradient difference: \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"fr", "[", 
     RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v1"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"ft", "[", 
     RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v2"}], " ", "+", " ", 
   RowBox[{
    RowBox[{"fp", "[", 
     RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v3"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gradDiff", " ", "=", " ", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"fr", "[", 
            RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v1"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"ft", "[", 
            RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v2"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"fp", "[", 
            RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v3"}]}], "]"}], "/.", 
        RowBox[{"r", " ", "->", "  ", "rp"}]}], " ", "/.", " ", 
       RowBox[{"t", "->", " ", "tp"}]}], " ", "/.", 
      RowBox[{"p", " ", "->", " ", "pp"}]}], "]"}], " ", "-", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"fr", "[", 
            RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v1"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"ft", "[", 
            RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v2"}], " ", "+", " ", 
          RowBox[{
           RowBox[{"fp", "[", 
            RowBox[{"r", ",", "t", ",", "p"}], "]"}], "v3"}]}], "]"}], "/.", 
        RowBox[{"r", " ", "->", "rq"}]}], " ", "/.", " ", 
       RowBox[{"t", "->", " ", "tq"}]}], " ", "/.", 
      RowBox[{"p", " ", "->", " ", "pq"}]}], "]"}]}]}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Computes", " ", "relative", " ", "postition"}], " ", 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pos", " ", "=", " ", 
   RowBox[{"r", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"Cos", "[", "p", "]"}]}], ",", " ", 
      RowBox[{
       RowBox[{"Sin", "[", "t", "]"}], 
       RowBox[{"Sin", "[", "p", "]"}]}], ",", " ", 
      RowBox[{"Cos", "[", "t", "]"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Relative position: \>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"relpos", " ", "=", " ", 
   RowBox[{
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pos", " ", "/.", 
        RowBox[{"r", " ", "->", "  ", "rp"}]}], " ", "/.", " ", 
       RowBox[{"t", "->", " ", "tp"}]}], " ", "/.", 
      RowBox[{"p", " ", "->", " ", "pp"}]}], "]"}], " ", "-", " ", 
    RowBox[{"N", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"pos", " ", "/.", 
        RowBox[{"r", " ", "->", "  ", "rq"}]}], " ", "/.", " ", 
       RowBox[{"t", "->", " ", "tq"}]}], " ", "/.", 
      RowBox[{"p", " ", "->", " ", "pq"}]}], "]"}]}]}], "\[IndentingNewLine]",
   "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Produce", " ", "the", " ", "projection", " ", "matrix"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Print", "[", "\"\<Projection matrix\>\"", 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"proj", " ", "=", " ", 
   RowBox[{"Simplify", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "3", "]"}], 
      RowBox[{"Dot", "[", 
       RowBox[{"relpos", ",", " ", "relpos"}], "]"}]}], "-", " ", 
     RowBox[{"Outer", "[", 
      RowBox[{"Times", ",", " ", "relpos", ",", " ", "relpos"}], "]"}]}], 
    "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"multiply", " ", "them"}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"Simplify", "[", 
  RowBox[{"Dot", "[", 
   RowBox[{"proj", ",", " ", "gradDiff"}], "]"}], 
  "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.936194757381897*^9, 3.936194764218136*^9}, {
  3.936369521207388*^9, 3.936369532921452*^9}, {3.936369582417054*^9, 
  3.936369628226427*^9}, {3.936369674015973*^9, 3.936369677033568*^9}, {
  3.9363697362181377`*^9, 3.936369737892434*^9}, {3.936369775876542*^9, 
  3.936369848953528*^9}, {3.9363698987046*^9, 3.936369949997389*^9}, {
  3.936372964403019*^9, 3.93637302608638*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"a2c32b29-c8bc-4686-abd4-13e7a4eb0639"],

Cell[BoxData["\<\"Test function:\"\>"], "Print",
 CellChangeTimes->{
  3.936369618721716*^9, 3.936369681751717*^9, 3.936369740920891*^9, 
   3.93636979561613*^9, 3.936369850260827*^9, {3.93636991451682*^9, 
   3.936369935739052*^9}, 3.936372966250581*^9, {3.9363729982867403`*^9, 
   3.9363730267448683`*^9}},
 CellLabel->
  "During evaluation of \
In[68]:=",ExpressionUUID->"ce7f0b7f-2acd-40d3-8d5c-e90eaaeef83a"],

Cell[BoxData[
 RowBox[{
  FractionBox["3", "2"], "-", 
  SuperscriptBox["r", "2"]}]], "Output",
 CellChangeTimes->{
  3.936369618817245*^9, 3.936369681752739*^9, 3.9363697409218407`*^9, 
   3.936369795617119*^9, 3.936369850261766*^9, {3.936369914517665*^9, 
   3.936369935739991*^9}, 3.936372966331547*^9, {3.936372998288134*^9, 
   3.936373026746108*^9}},
 CellLabel->"Out[74]=",ExpressionUUID->"68982e42-3e6c-421d-a3be-b123b80f771d"],

Cell[BoxData["\<\"Gradient difference: \"\>"], "Print",
 CellChangeTimes->{
  3.936369618721716*^9, 3.936369681751717*^9, 3.936369740920891*^9, 
   3.93636979561613*^9, 3.936369850260827*^9, {3.93636991451682*^9, 
   3.936369935739052*^9}, 3.936372966250581*^9, {3.9363729982867403`*^9, 
   3.936373026747336*^9}},
 CellLabel->
  "During evaluation of \
In[68]:=",ExpressionUUID->"51affc94-cc1f-4c9a-ad1b-9eb3282e58b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "2"}], " ", "r", " ", 
    RowBox[{"Cos", "[", "p", "]"}], " ", 
    RowBox[{"Sin", "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "r", " ", 
    RowBox[{"Sin", "[", "p", "]"}], " ", 
    RowBox[{"Sin", "[", "t", "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", "2"}], " ", "r", " ", 
    RowBox[{"Cos", "[", "t", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.936369618817245*^9, 3.936369681752739*^9, 3.9363697409218407`*^9, 
   3.936369795617119*^9, 3.936369850261766*^9, {3.936369914517665*^9, 
   3.936369935739991*^9}, 3.936372966331547*^9, {3.936372998288134*^9, 
   3.9363730267484922`*^9}},
 CellLabel->"Out[82]=",ExpressionUUID->"a815ba72-2190-4836-9cfa-12394d7c75eb"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "2.`"}], " ", "rp", " ", 
     RowBox[{"Cos", "[", "pp", "]"}], " ", 
     RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
    RowBox[{"2.`", " ", "rq", " ", 
     RowBox[{"Cos", "[", "pq", "]"}], " ", 
     RowBox[{"Sin", "[", "tq", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2.`"}], " ", "rp", " ", 
     RowBox[{"Sin", "[", "pp", "]"}], " ", 
     RowBox[{"Sin", "[", "tp", "]"}]}], "+", 
    RowBox[{"2.`", " ", "rq", " ", 
     RowBox[{"Sin", "[", "pq", "]"}], " ", 
     RowBox[{"Sin", "[", "tq", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "2.`"}], " ", "rp", " ", 
     RowBox[{"Cos", "[", "tp", "]"}]}], "+", 
    RowBox[{"2.`", " ", "rq", " ", 
     RowBox[{"Cos", "[", "tq", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.936369618817245*^9, 3.936369681752739*^9, 3.9363697409218407`*^9, 
   3.936369795617119*^9, 3.936369850261766*^9, {3.936369914517665*^9, 
   3.936369935739991*^9}, 3.936372966331547*^9, {3.936372998288134*^9, 
   3.936373026749748*^9}},
 CellLabel->"Out[83]=",ExpressionUUID->"6a6b40ce-e5c1-42f5-8ed7-463dc016262e"],

Cell[BoxData["\<\"Relative position: \"\>"], "Print",
 CellChangeTimes->{
  3.936369618721716*^9, 3.936369681751717*^9, 3.936369740920891*^9, 
   3.93636979561613*^9, 3.936369850260827*^9, {3.93636991451682*^9, 
   3.936369935739052*^9}, 3.936372966250581*^9, {3.9363729982867403`*^9, 
   3.936373026751013*^9}},
 CellLabel->
  "During evaluation of \
In[68]:=",ExpressionUUID->"8fa0da77-edf9-4be1-83f2-ad32b9883caf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"rp", " ", 
     RowBox[{"Cos", "[", "pp", "]"}], " ", 
     RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
    RowBox[{"rq", " ", 
     RowBox[{"Cos", "[", "pq", "]"}], " ", 
     RowBox[{"Sin", "[", "tq", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"rp", " ", 
     RowBox[{"Sin", "[", "pp", "]"}], " ", 
     RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
    RowBox[{"rq", " ", 
     RowBox[{"Sin", "[", "pq", "]"}], " ", 
     RowBox[{"Sin", "[", "tq", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"rp", " ", 
     RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
    RowBox[{"rq", " ", 
     RowBox[{"Cos", "[", "tq", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.936369618817245*^9, 3.936369681752739*^9, 3.9363697409218407`*^9, 
   3.936369795617119*^9, 3.936369850261766*^9, {3.936369914517665*^9, 
   3.936369935739991*^9}, 3.936372966331547*^9, {3.936372998288134*^9, 
   3.936373026752338*^9}},
 CellLabel->"Out[86]=",ExpressionUUID->"72ef9562-f096-4bd2-8b06-a97661ce82f4"],

Cell[BoxData["\<\"Projection matrix\"\>"], "Print",
 CellChangeTimes->{
  3.936369618721716*^9, 3.936369681751717*^9, 3.936369740920891*^9, 
   3.93636979561613*^9, 3.936369850260827*^9, {3.93636991451682*^9, 
   3.936369935739052*^9}, 3.936372966250581*^9, {3.9363729982867403`*^9, 
   3.936373026753718*^9}},
 CellLabel->
  "During evaluation of \
In[68]:=",ExpressionUUID->"77f774b1-9a24-4dde-8e34-14e1b2d67836"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rp", " ", 
          RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
         RowBox[{"rq", " ", 
          RowBox[{"Cos", "[", "tq", "]"}]}]}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rp", " ", 
          RowBox[{"Sin", "[", "pp", "]"}], " ", 
          RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
         RowBox[{"rq", " ", 
          RowBox[{"Sin", "[", "pq", "]"}], " ", 
          RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], "2"]}], ",", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Sin", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Sin", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}]}], ")"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "tq", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}]}], ")"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Sin", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Sin", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}]}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rp", " ", 
          RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
         RowBox[{"rq", " ", 
          RowBox[{"Cos", "[", "tq", "]"}]}]}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rp", " ", 
          RowBox[{"Cos", "[", "pp", "]"}], " ", 
          RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
         RowBox[{"rq", " ", 
          RowBox[{"Cos", "[", "pq", "]"}], " ", 
          RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], "2"]}], ",", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "tq", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Sin", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Sin", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}]}], ")"}]}]}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "tq", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}]}], ")"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Cos", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Cos", "[", "tq", "]"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"rp", " ", 
           RowBox[{"Sin", "[", "pp", "]"}], " ", 
           RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
          RowBox[{"rq", " ", 
           RowBox[{"Sin", "[", "pq", "]"}], " ", 
           RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}]}], ")"}]}], ",", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rp", " ", 
          RowBox[{"Cos", "[", "pp", "]"}], " ", 
          RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
         RowBox[{"rq", " ", 
          RowBox[{"Cos", "[", "pq", "]"}], " ", 
          RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], "2"], "+", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"rp", " ", 
          RowBox[{"Sin", "[", "pp", "]"}], " ", 
          RowBox[{"Sin", "[", "tp", "]"}]}], "-", 
         RowBox[{"rq", " ", 
          RowBox[{"Sin", "[", "pq", "]"}], " ", 
          RowBox[{"Sin", "[", "tq", "]"}]}]}], ")"}], "2"]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.936369618817245*^9, 3.936369681752739*^9, 3.9363697409218407`*^9, 
   3.936369795617119*^9, 3.936369850261766*^9, {3.936369914517665*^9, 
   3.936369935739991*^9}, 3.936372966331547*^9, {3.936372998288134*^9, 
   3.936373026755582*^9}},
 CellLabel->"Out[88]=",ExpressionUUID->"cb36b820-40f0-4681-a9b4-cfaea950fe1b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.`", ",", "0.`", ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.936369618817245*^9, 3.936369681752739*^9, 3.9363697409218407`*^9, 
   3.936369795617119*^9, 3.936369850261766*^9, {3.936369914517665*^9, 
   3.936369935739991*^9}, 3.936372966331547*^9, {3.936372998288134*^9, 
   3.936373026757353*^9}},
 CellLabel->"Out[89]=",ExpressionUUID->"a959a209-7b6e-4adc-b9c4-f4276f1a3a23"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.9346627413420258`*^9, 
  3.934662741343395*^9}},ExpressionUUID->"7f66bc74-c433-4697-b1df-\
b83dfb90b520"],

Cell[BoxData[
 FractionBox["\[Pi]", "4"]], "Output",
 CellChangeTimes->{{3.934646473643909*^9, 3.934646483992964*^9}, 
   3.934646548484581*^9, 3.934646628364702*^9, 3.9346466771495442`*^9, 
   3.934646753559991*^9, {3.9346468540118833`*^9, 3.934646864082214*^9}},
 CellLabel->
  "Out[1015]=",ExpressionUUID->"2b74f864-7864-479d-9391-cbe066a0f865"],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.934646473643909*^9, 3.934646483992964*^9}, 
   3.934646548484581*^9, 3.934646628364702*^9, 3.9346466771495442`*^9, 
   3.934646753559991*^9, {3.9346468540118833`*^9, 3.93464686408455*^9}},
 CellLabel->
  "Out[1016]=",ExpressionUUID->"5eab3629-84f5-4746-a5d9-897df4b89a77"],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.934646473643909*^9, 3.934646483992964*^9}, 
   3.934646548484581*^9, 3.934646628364702*^9, 3.9346466771495442`*^9, 
   3.934646753559991*^9, {3.9346468540118833`*^9, 3.9346468640873547`*^9}},
 CellLabel->
  "Out[1017]=",ExpressionUUID->"a50eeea0-3166-4222-a66f-9f79df124dd9"],

Cell[BoxData[
 FractionBox["\[Pi]", "5"]], "Output",
 CellChangeTimes->{{3.934646473643909*^9, 3.934646483992964*^9}, 
   3.934646548484581*^9, 3.934646628364702*^9, 3.9346466771495442`*^9, 
   3.934646753559991*^9, {3.9346468540118833`*^9, 3.934646864089253*^9}},
 CellLabel->
  "Out[1018]=",ExpressionUUID->"8034773e-9fb3-4f97-98d6-ec27a1380c15"],

Cell[BoxData[
 FractionBox["\[Pi]", "7"]], "Output",
 CellChangeTimes->{{3.934646473643909*^9, 3.934646483992964*^9}, 
   3.934646548484581*^9, 3.934646628364702*^9, 3.9346466771495442`*^9, 
   3.934646753559991*^9, {3.9346468540118833`*^9, 3.934646864091016*^9}},
 CellLabel->
  "Out[1019]=",ExpressionUUID->"9d8edfa2-aca5-4071-9845-3cccab4e5adc"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.934646543118364*^9, 
  3.934646544817011*^9}},ExpressionUUID->"dcee5fb1-32de-49c1-b578-\
aa2c32110548"],

Cell[BoxData[
 FractionBox["\[Pi]", "5"]], "Output",
 CellChangeTimes->{{3.934646473643909*^9, 3.934646484000225*^9}},
 CellLabel->
  "Out[935]=",ExpressionUUID->"511f103a-86a4-40ee-a52a-216e91511d9a"],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "\[Pi]"}], "5"]], "Output",
 CellChangeTimes->{{3.934646473643909*^9, 3.934646484001792*^9}},
 CellLabel->
  "Out[936]=",ExpressionUUID->"ae704dcd-7595-4370-913b-e3c64707da8a"]
}, Open  ]],

Cell[, "Input",ExpressionUUID->"70b762c1-7c03-4495-9e17-da10abbaaa56"],

Cell[CellGroupData[{

Cell[, "Input",ExpressionUUID->"1e34d36c-46f4-4c9d-a136-efded67e8ced"],

Cell[, "Output",ExpressionUUID->"3b3929a6-b490-4707-a113-6c2d76eff06b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Input",ExpressionUUID->"25c87648-220c-4e74-9752-e148e6ee5aa2"],

Cell[, "Output",ExpressionUUID->"91cc75ff-fe64-42d1-843e-962d6dd942ff"]
}, Open  ]],

Cell[, "Input",ExpressionUUID->"5a6f9d6d-e772-403b-95c3-a63a4d504a02"],

Cell[, "Input",ExpressionUUID->"35f6954c-e7c8-48e2-8d95-e547b18aed6c"],

Cell[CellGroupData[{

Cell[, "Input",ExpressionUUID->"8347e01b-ac0a-4fab-a3a4-8695219a0d5d"],

Cell[, "Output",ExpressionUUID->"7a923e08-c52e-4fa0-a415-1fd85078df35"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Input",ExpressionUUID->"ca9805cf-34ee-46bb-afdb-867b59b4fc7b"],

Cell[, "Output",ExpressionUUID->"2b288c70-9d60-44b0-b601-eb0c2e7aaeac"]
}, Open  ]],

Cell[, "Input",ExpressionUUID->"cb4ba9c0-91e2-4de5-8e2b-0b280d286e03"],

Cell[CellGroupData[{

Cell[, "Input",ExpressionUUID->"aba867e4-d3ad-452b-819b-2ef72b937583"],

Cell[, "Output",ExpressionUUID->"033a13e2-b837-4395-beff-83adce71005f"]
}, Open  ]],

Cell[, "Input",ExpressionUUID->"bba1128f-45af-41fe-adf7-15200c7988d2"],

Cell[CellGroupData[{

Cell[, "Input",ExpressionUUID->"ae0b20f5-82dd-4918-9a0f-7fde28989718"],

Cell[, "Output",ExpressionUUID->"e844b440-c780-463a-a9a6-803b193bd0b0"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Input",ExpressionUUID->"960e8ffb-f722-45dc-8b04-0a09770ab02a"],

Cell[, "Output",ExpressionUUID->"748ed7a3-16eb-49f5-a7d0-1cb10366f290"],

Cell[, "Output",ExpressionUUID->"1e68675c-0ac7-4403-9822-acec815c3159"],

Cell[, "Output",ExpressionUUID->"86487dde-f046-49d4-9469-dc89e14d7226"],

Cell[, "Output",ExpressionUUID->"8a3d2577-7d1a-4e63-a429-01781647ae7a"],

Cell[, "Output",ExpressionUUID->"3c263c3d-9659-4b27-9570-4627ec82dc53"],

Cell[, "Output",ExpressionUUID->"7e6cf590-2bf9-4371-96a0-8db9403cdd81"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Input",ExpressionUUID->"0561b78b-9c9c-42ff-9deb-c19038d454d8"],

Cell[, "Output",ExpressionUUID->"3819884b-d94e-45ea-b8ce-510951b2c2aa"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Input",ExpressionUUID->"aefb6dfd-840b-408d-9e5c-6b5f9af03710"],

Cell[, "Output",ExpressionUUID->"32278a2f-1622-4c23-a216-8028a9241fc6"]
}, Open  ]],

Cell[CellGroupData[{

Cell[, "Input",ExpressionUUID->"d83846b4-5dfa-40b3-8e5b-d6d6f94fab9d"],

Cell[, "Output",ExpressionUUID->"c7fddc43-24a6-473c-81a7-bf99b4fc2e1c"]
}, Open  ]]
},
WindowSize->{Full, Full},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.1 Inherited,
FrontEndVersion->"14.0 for Linux x86 (64-bit) (December 12, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"fe280169-b9db-4e6a-969e-52152d7733ea"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 152, 3, 32, "Input",ExpressionUUID->"d0d9a694-3679-4108-bfea-27ee88836749"],
Cell[CellGroupData[{
Cell[735, 27, 22078, 571, 2016, "Input",ExpressionUUID->"68a86d45-4d3f-440c-bb66-18be05013b7d"],
Cell[22816, 600, 2199, 32, 25, "Print",ExpressionUUID->"3188b5d4-db06-4f2b-bafc-0724d4174f1b"],
Cell[25018, 634, 3309, 53, 51, "Output",ExpressionUUID->"3b4d84f3-3c28-4dea-9c36-f9febe47120a"],
Cell[28330, 689, 2208, 32, 25, "Print",ExpressionUUID->"eaeb2018-7079-4c77-ab6c-acd4592590c5"],
Cell[30541, 723, 4161, 81, 51, "Output",ExpressionUUID->"b1c86be7-8a24-42bc-ade2-1ad1c135e6d5"],
Cell[34705, 806, 5365, 117, 64, "Output",ExpressionUUID->"d8c47db5-266e-43d6-845c-f0b6f36daff5"],
Cell[40073, 925, 2204, 32, 25, "Print",ExpressionUUID->"0031350b-0d34-43f9-9aae-a98c5ae216f4"],
Cell[42280, 959, 3720, 65, 39, "Output",ExpressionUUID->"7903f5e2-e81a-4d85-bf82-cd3a18ae6f51"],
Cell[46003, 1026, 2199, 32, 25, "Print",ExpressionUUID->"1c7b8737-92c2-4020-a930-70c7c39c30c0"],
Cell[48205, 1060, 6527, 149, 89, "Output",ExpressionUUID->"ccfe5ce4-ec5a-4260-8c00-df9815a96093"],
Cell[54735, 1211, 2194, 32, 25, "Print",ExpressionUUID->"2934d6b6-81d2-4ffb-844d-6db2c0ff7ee3"],
Cell[56932, 1245, 3999, 71, 39, "Output",ExpressionUUID->"1a289ed0-9bea-4d74-9de4-219d8a4b2538"],
Cell[60934, 1318, 2198, 32, 25, "Print",ExpressionUUID->"3e2d107c-d470-4c89-bb52-a89eec1a1bf1"],
Cell[63135, 1352, 17125, 416, 451, "Output",ExpressionUUID->"8eba082f-3395-4a4f-8a9e-9d136dd69318"],
Cell[80263, 1770, 2200, 32, 25, "Print",ExpressionUUID->"092de6f2-5b97-4599-a5be-0241477d94fa"],
Cell[82466, 1804, 12187, 294, 277, "Output",ExpressionUUID->"50f380ba-f7ea-4136-b896-79a397143eda"]
}, Open  ]],
Cell[CellGroupData[{
Cell[94690, 2103, 1798, 38, 57, "Input",ExpressionUUID->"37c35491-c116-4a47-88f3-4c0787afe9f5"],
Cell[96491, 2143, 522, 12, 39, "Output",ExpressionUUID->"4a55ed4d-da04-4190-8ac3-5d79c626c7db"],
Cell[97016, 2157, 9973, 272, 281, "Output",ExpressionUUID->"7b176ff0-f523-4bd7-b599-db3f6ca60378"]
}, Open  ]],
Cell[107004, 2432, 152, 3, 32, "Input",ExpressionUUID->"b42f0e6d-a54a-4605-a35f-41a77a03f171"],
Cell[107159, 2437, 152, 3, 32, "Input",ExpressionUUID->"99327fe0-999b-458c-b935-95aef60a8631"],
Cell[CellGroupData[{
Cell[107336, 2444, 988, 22, 35, "Input",ExpressionUUID->"0ca220d8-1bdf-4070-8090-a9046f618138"],
Cell[108327, 2468, 559, 10, 36, "Output",ExpressionUUID->"bd862644-d73e-4900-87c5-5bce31de8391"]
}, Open  ]],
Cell[108901, 2481, 25017, 716, 2865, "Input",ExpressionUUID->"06b597a2-7a7d-4bd7-b4bd-e846a5d0a253"],
Cell[133921, 3199, 152, 3, 32, "Input",ExpressionUUID->"f41a33d9-2e65-427f-85d9-a57f329bc01a"],
Cell[CellGroupData[{
Cell[134098, 3206, 8501, 235, 932, "Input",ExpressionUUID->"a2c32b29-c8bc-4686-abd4-13e7a4eb0639"],
Cell[142602, 3443, 414, 8, 25, "Print",ExpressionUUID->"ce7f0b7f-2acd-40d3-8d5c-e90eaaeef83a"],
Cell[143019, 3453, 435, 9, 51, "Output",ExpressionUUID->"68982e42-3e6c-421d-a3be-b123b80f771d"],
Cell[143457, 3464, 419, 8, 25, "Print",ExpressionUUID->"51affc94-cc1f-4c9a-ad1b-9eb3282e58b4"],
Cell[143879, 3474, 767, 19, 38, "Output",ExpressionUUID->"a815ba72-2190-4836-9cfa-12394d7c75eb"],
Cell[144649, 3495, 1166, 30, 38, "Output",ExpressionUUID->"6a6b40ce-e5c1-42f5-8ed7-463dc016262e"],
Cell[145818, 3527, 417, 8, 25, "Print",ExpressionUUID->"8fa0da77-edf9-4be1-83f2-ad32b9883caf"],
Cell[146238, 3537, 1031, 27, 38, "Output",ExpressionUUID->"72ef9562-f096-4bd2-8b06-a97661ce82f4"],
Cell[147272, 3566, 415, 8, 25, "Print",ExpressionUUID->"77f774b1-9a24-4dde-8e34-14e1b2d67836"],
Cell[147690, 3576, 6123, 176, 137, "Output",ExpressionUUID->"cb36b820-40f0-4681-a9b4-cfaea950fe1b"],
Cell[153816, 3754, 429, 8, 36, "Output",ExpressionUUID->"a959a209-7b6e-4adc-b9c4-f4276f1a3a23"]
}, Open  ]],
Cell[CellGroupData[{
Cell[154282, 3767, 154, 3, 31, "Input",ExpressionUUID->"7f66bc74-c433-4697-b1df-b83dfb90b520"],
Cell[154439, 3772, 348, 6, 50, "Output",ExpressionUUID->"2b74f864-7864-479d-9391-cbe066a0f865"],
Cell[154790, 3780, 323, 5, 36, "Output",ExpressionUUID->"5eab3629-84f5-4746-a5d9-897df4b89a77"],
Cell[155116, 3787, 326, 5, 36, "Output",ExpressionUUID->"a50eeea0-3166-4222-a66f-9f79df124dd9"],
Cell[155445, 3794, 348, 6, 50, "Output",ExpressionUUID->"8034773e-9fb3-4f97-98d6-ec27a1380c15"],
Cell[155796, 3802, 348, 6, 50, "Output",ExpressionUUID->"9d8edfa2-aca5-4071-9845-3cccab4e5adc"]
}, Open  ]],
Cell[CellGroupData[{
Cell[156181, 3813, 152, 3, 31, "Input",ExpressionUUID->"dcee5fb1-32de-49c1-b578-aa2c32110548"],
Cell[156336, 3818, 201, 4, 50, "Output",ExpressionUUID->"511f103a-86a4-40ee-a52a-216e91511d9a"],
Cell[156540, 3824, 224, 5, 57, "Output",ExpressionUUID->"ae704dcd-7595-4370-913b-e3c64707da8a"]
}, Open  ]],
Cell[156779, 3832, 70, 0, 33, "Input",ExpressionUUID->"70b762c1-7c03-4495-9e17-da10abbaaa56"],
Cell[CellGroupData[{
Cell[156874, 3836, 70, 0, 33, "Input",ExpressionUUID->"1e34d36c-46f4-4c9d-a136-efded67e8ced"],
Cell[156947, 3838, 71, 0, 37, "Output",ExpressionUUID->"3b3929a6-b490-4707-a113-6c2d76eff06b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157055, 3843, 70, 0, 33, "Input",ExpressionUUID->"25c87648-220c-4e74-9752-e148e6ee5aa2"],
Cell[157128, 3845, 71, 0, 37, "Output",ExpressionUUID->"91cc75ff-fe64-42d1-843e-962d6dd942ff"]
}, Open  ]],
Cell[157214, 3848, 70, 0, 33, "Input",ExpressionUUID->"5a6f9d6d-e772-403b-95c3-a63a4d504a02"],
Cell[157287, 3850, 70, 0, 33, "Input",ExpressionUUID->"35f6954c-e7c8-48e2-8d95-e547b18aed6c"],
Cell[CellGroupData[{
Cell[157382, 3854, 70, 0, 33, "Input",ExpressionUUID->"8347e01b-ac0a-4fab-a3a4-8695219a0d5d"],
Cell[157455, 3856, 71, 0, 37, "Output",ExpressionUUID->"7a923e08-c52e-4fa0-a415-1fd85078df35"]
}, Open  ]],
Cell[CellGroupData[{
Cell[157563, 3861, 70, 0, 33, "Input",ExpressionUUID->"ca9805cf-34ee-46bb-afdb-867b59b4fc7b"],
Cell[157636, 3863, 71, 0, 37, "Output",ExpressionUUID->"2b288c70-9d60-44b0-b601-eb0c2e7aaeac"]
}, Open  ]],
Cell[157722, 3866, 70, 0, 33, "Input",ExpressionUUID->"cb4ba9c0-91e2-4de5-8e2b-0b280d286e03"],
Cell[CellGroupData[{
Cell[157817, 3870, 70, 0, 33, "Input",ExpressionUUID->"aba867e4-d3ad-452b-819b-2ef72b937583"],
Cell[157890, 3872, 71, 0, 37, "Output",ExpressionUUID->"033a13e2-b837-4395-beff-83adce71005f"]
}, Open  ]],
Cell[157976, 3875, 70, 0, 33, "Input",ExpressionUUID->"bba1128f-45af-41fe-adf7-15200c7988d2"],
Cell[CellGroupData[{
Cell[158071, 3879, 70, 0, 33, "Input",ExpressionUUID->"ae0b20f5-82dd-4918-9a0f-7fde28989718"],
Cell[158144, 3881, 71, 0, 37, "Output",ExpressionUUID->"e844b440-c780-463a-a9a6-803b193bd0b0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158252, 3886, 70, 0, 33, "Input",ExpressionUUID->"960e8ffb-f722-45dc-8b04-0a09770ab02a"],
Cell[158325, 3888, 71, 0, 37, "Output",ExpressionUUID->"748ed7a3-16eb-49f5-a7d0-1cb10366f290"],
Cell[158399, 3890, 71, 0, 37, "Output",ExpressionUUID->"1e68675c-0ac7-4403-9822-acec815c3159"],
Cell[158473, 3892, 71, 0, 37, "Output",ExpressionUUID->"86487dde-f046-49d4-9469-dc89e14d7226"],
Cell[158547, 3894, 71, 0, 37, "Output",ExpressionUUID->"8a3d2577-7d1a-4e63-a429-01781647ae7a"],
Cell[158621, 3896, 71, 0, 37, "Output",ExpressionUUID->"3c263c3d-9659-4b27-9570-4627ec82dc53"],
Cell[158695, 3898, 71, 0, 37, "Output",ExpressionUUID->"7e6cf590-2bf9-4371-96a0-8db9403cdd81"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158803, 3903, 70, 0, 33, "Input",ExpressionUUID->"0561b78b-9c9c-42ff-9deb-c19038d454d8"],
Cell[158876, 3905, 71, 0, 37, "Output",ExpressionUUID->"3819884b-d94e-45ea-b8ce-510951b2c2aa"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158984, 3910, 70, 0, 33, "Input",ExpressionUUID->"aefb6dfd-840b-408d-9e5c-6b5f9af03710"],
Cell[159057, 3912, 71, 0, 37, "Output",ExpressionUUID->"32278a2f-1622-4c23-a216-8028a9241fc6"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159165, 3917, 70, 0, 33, "Input",ExpressionUUID->"d83846b4-5dfa-40b3-8e5b-d6d6f94fab9d"],
Cell[159238, 3919, 71, 0, 37, "Output",ExpressionUUID->"c7fddc43-24a6-473c-81a7-bf99b4fc2e1c"]
}, Open  ]]
}
]
*)

